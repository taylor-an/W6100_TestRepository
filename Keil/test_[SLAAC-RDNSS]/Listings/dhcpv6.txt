; generated by Component: ARM Compiler 5.06 update 6 (build 750) Tool: ArmCC [4d3637]
; commandline ArmCC [--c99 --list --debug -c --asm --interleave -o.\objects\dhcpv6.o --asm_dir=.\Listings\ --list_dir=.\Listings\ --depend=.\objects\dhcpv6.d --cpu=Cortex-M4.fp --apcs=interwork --diag_suppress=9931 -I..\test_[SLAAC-RDNSS] -I..\..\Libraries\CMSIS\Device\ST\STM32F4xx\Include -I..\..\Libraries\CMSIS\Include -I..\..\Libraries\io6Library\Application\loopback -I..\..\Libraries\io6Library\Ethernet -I..\..\Libraries\io6Library\Ethernet\W6100 -I..\..\Libraries\io6Library\Internet\DHCP -I..\..\Libraries\io6Library\Internet\DNS -I..\..\Libraries\STM32F4xx_StdPeriph_Driver\inc -I..\..\Libraries\io6Library\Internet\DHCP6 -I.\RTE\_Target_1 -Ic:\Keil_v5\ARM\PACK\Keil\STM32F4xx_DFP\2.13.0\Drivers\CMSIS\Device\ST\STM32F4xx\Include -Ic:\Keil_v5\ARM\CMSIS\Include -D__UVISION_VERSION=525 -DSTM32F407xx -DSTM32F4XX -DUSE_STDPERIPH_DRIVER --omf_browse=.\objects\dhcpv6.crf ..\..\Libraries\io6Library\Internet\DHCP6\dhcpv6.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                          REQUIRE _printf_pre_padding
                          REQUIRE _printf_percent
                          REQUIRE _printf_flags
                          REQUIRE _printf_widthprec
                          REQUIRE _printf_d
                          REQUIRE _printf_s
                          REQUIRE _printf_int_dec
                          REQUIRE _printf_str
                          REQUIRE _printf_x
                          REQUIRE _printf_longlong_hex
                  InitDhcpOption PROC
;;;185    
;;;186    void InitDhcpOption(unsigned asize, unsigned agrowby)
000000  b510              PUSH     {r4,lr}
;;;187    {
;;;188        size=asize;
000002  4afe              LDR      r2,|L1.1020|
;;;189        growby=agrowby;
;;;190        num=0;
000004  6511              STR      r1,[r2,#0x50]  ; growby
000006  2100              MOVS     r1,#0
000008  e9c20112          STRD     r0,r1,[r2,#0x48]
;;;191        pDHCPMSG.OPT = (uint8_t *)malloc(size*sizeof(uint8_t));
00000c  f7fffffe          BL       malloc
000010  49fa              LDR      r1,|L1.1020|
000012  3128              ADDS     r1,r1,#0x28
000014  6008              STR      r0,[r1,#0]  ; pDHCPMSG
;;;192    }
000016  bd10              POP      {r4,pc}
;;;193    
                          ENDP

                  InsertDhcpOption PROC
;;;194    void InsertDhcpOption(int idx, uint8_t value)
000018  e92d41f0          PUSH     {r4-r8,lr}
;;;195    {
;;;196        unsigned need;
;;;197     
;;;198        need=num+1;
00001c  4df7              LDR      r5,|L1.1020|
00001e  460f              MOV      r7,r1                 ;195
000020  4604              MOV      r4,r0                 ;195
;;;199        if (need > size) {
;;;200             size=need+growby;
;;;201             pDHCPMSG.OPT = (uint8_t *)realloc(pDHCPMSG.OPT,size*sizeof(uint8_t));
000022  e9d51012          LDRD     r1,r0,[r5,#0x48]
000026  1c40              ADDS     r0,r0,#1
000028  f1050628          ADD      r6,r5,#0x28
00002c  4288              CMP      r0,r1                 ;199
00002e  d906              BLS      |L1.62|
000030  6d29              LDR      r1,[r5,#0x50]         ;200  ; growby
000032  4401              ADD      r1,r1,r0              ;200
000034  64a9              STR      r1,[r5,#0x48]  ; size
000036  6830              LDR      r0,[r6,#0]  ; pDHCPMSG
000038  f7fffffe          BL       realloc
00003c  6030              STR      r0,[r6,#0]  ; pDHCPMSG
                  |L1.62|
;;;202        }
;;;203        memmove(&pDHCPMSG.OPT[idx+1],&pDHCPMSG.OPT[idx],(num-idx)*sizeof(uint8_t));
00003e  6ce8              LDR      r0,[r5,#0x4c]  ; num
000040  1c63              ADDS     r3,r4,#1
000042  1b02              SUBS     r2,r0,r4
000044  6830              LDR      r0,[r6,#0]  ; pDHCPMSG
000046  1901              ADDS     r1,r0,r4
000048  4418              ADD      r0,r0,r3
00004a  f7fffffe          BL       __aeabi_memmove
;;;204        pDHCPMSG.OPT[idx]=value;
00004e  6830              LDR      r0,[r6,#0]  ; pDHCPMSG
000050  5507              STRB     r7,[r0,r4]
;;;205        num++;
000052  6ce8              LDR      r0,[r5,#0x4c]  ; num
000054  1c40              ADDS     r0,r0,#1
000056  64e8              STR      r0,[r5,#0x4c]  ; num
                  |L1.88|
;;;206    }
000058  e8bd81f0          POP      {r4-r8,pc}
;;;207    
                          ENDP

                  DeleteDhcpOption PROC
;;;208    void DeleteDhcpOption(int idx)
00005c  b510              PUSH     {r4,lr}
;;;209    {
;;;210        memmove(pDHCPMSG.OPT+idx,pDHCPMSG.OPT+idx+1,(num-idx-1)*sizeof(uint8_t));
00005e  4ce7              LDR      r4,|L1.1020|
000060  6ce1              LDR      r1,[r4,#0x4c]  ; num
000062  1a0a              SUBS     r2,r1,r0
000064  f1040128          ADD      r1,r4,#0x28
000068  1e52              SUBS     r2,r2,#1
00006a  680b              LDR      r3,[r1,#0]  ; pDHCPMSG
00006c  1c41              ADDS     r1,r0,#1
00006e  4419              ADD      r1,r1,r3
000070  4418              ADD      r0,r0,r3
000072  f7fffffe          BL       __aeabi_memmove
;;;211        num--;
000076  6ce0              LDR      r0,[r4,#0x4c]  ; num
000078  1e40              SUBS     r0,r0,#1
00007a  64e0              STR      r0,[r4,#0x4c]  ; num
;;;212    }
00007c  bd10              POP      {r4,pc}
;;;213    
                          ENDP

                  AppendDhcpOption PROC
;;;214    void AppendDhcpOption(uint8_t value)
00007e  4601              MOV      r1,r0
;;;215    {
;;;216        InsertDhcpOption(num,value);
000080  48de              LDR      r0,|L1.1020|
000082  6cc0              LDR      r0,[r0,#0x4c]  ; num
000084  e7fe              B        InsertDhcpOption
;;;217    }
;;;218    
                          ENDP

                  UnInitDhcpOption PROC
;;;219    void UnInitDhcpOption(void)
000086  48dd              LDR      r0,|L1.1020|
;;;220    {
;;;221        free(pDHCPMSG.OPT);
000088  3028              ADDS     r0,r0,#0x28
00008a  6800              LDR      r0,[r0,#0]  ; pDHCPMSG
00008c  f7ffbffe          B.W      free
;;;222    }
;;;223    
                          ENDP

                  DumpDhcpOption PROC
;;;224    void DumpDhcpOption(char *sMark)
000090  b570              PUSH     {r4-r6,lr}
;;;225    {
;;;226         unsigned i;
;;;227         printf("%20s => size=%02d,num=%02d : ",sMark,size,num);
000092  4dda              LDR      r5,|L1.1020|
000094  4601              MOV      r1,r0
000096  a0da              ADR      r0,|L1.1024|
000098  e9d52312          LDRD     r2,r3,[r5,#0x48]
00009c  f7fffffe          BL       __2printf
;;;228         for (i=num2;i<num;i++) {
;;;229              printf("%.2x ",pDHCPMSG.OPT[i]);
0000a0  f1050628          ADD      r6,r5,#0x28
0000a4  6a2c              LDR      r4,[r5,#0x20]         ;228  ; num2
0000a6  e005              B        |L1.180|
                  |L1.168|
0000a8  6830              LDR      r0,[r6,#0]  ; pDHCPMSG
0000aa  5d01              LDRB     r1,[r0,r4]
0000ac  a0dc              ADR      r0,|L1.1056|
0000ae  f7fffffe          BL       __2printf
0000b2  1c64              ADDS     r4,r4,#1
                  |L1.180|
0000b4  6ce8              LDR      r0,[r5,#0x4c]         ;228  ; num
0000b6  4284              CMP      r4,r0                 ;228
0000b8  d3f6              BCC      |L1.168|
;;;230         }
;;;231         printf("\r\n");
0000ba  a0db              ADR      r0,|L1.1064|
0000bc  f7fffffe          BL       __2printf
;;;232         num2 = num;
0000c0  6ce8              LDR      r0,[r5,#0x4c]  ; num
0000c2  6228              STR      r0,[r5,#0x20]  ; num2
;;;233    }
0000c4  bd70              POP      {r4-r6,pc}
;;;234    
                          ENDP

                  DHCP_Option_Select PROC
;;;235    void DHCP_Option_Select(uint8_t option)
0000c6  4770              BX       lr
;;;236    {
;;;237        switch(option)
;;;238            case OPT_CLIENTID :
;;;239            case OPT_SERVERID :
;;;240            case OPT_IANA :
;;;241            case OPT_IATA :
;;;242            case OPT_IAADDR :
;;;243            case OPT_REQUEST :
;;;244            case OPT_PREFERENCE :
;;;245            case OPT_ELAPSED_TIME :
;;;246            case OPT_RELAY_MSG :
;;;247            case OPT_AUTH :
;;;248            case OPT_UNICAST :
;;;249            case OPT_STATUS_CODE :
;;;250            case OPT_RAPID_COMMIT :
;;;251            case OPT_USER_CLASS :
;;;252            case OPT_VENDOR_CLASS :
;;;253            case OPT_VENDOR_OPTS :
;;;254            case OPT_INTERFACE_ID :
;;;255            case OPT_RECONF_MSG :
;;;256            case OPT_RECONF_ACCEPT :
;;;257            case SIP_Server_DNL :
;;;258            case SIP_Server_V6ADDR :
;;;259            case DNS_RecursiveNameServer :
;;;260            case Domain_Search_List :
;;;261            case OPT_IAPD :
;;;262            case OPT_IAPREFIX :
;;;263            case OPT_NIS_SERVERS :
;;;264            case OPT_NISP_SERVERS :
;;;265            case OPT_NIS_DOMAIN_NAME :
;;;266            case OPT_NISP_DOMAIN_NAME :
;;;267            case FQ_DOMAIN_NAME :
;;;268            break;
;;;269    }
;;;270    
                          ENDP

                  send_DHCP_SOLICIT PROC
;;;271    /* SEND DHCPv6 SOLICIT */
;;;272    void send_DHCP_SOLICIT(void)
0000c8  b570              PUSH     {r4-r6,lr}
;;;273    {
;;;274    	uint16_t j;
;;;275    	uint8_t ip[16];
;;;276        uint8_t rip_msg_size;
;;;277        
;;;278        size = 0;
0000ca  4dcc              LDR      r5,|L1.1020|
0000cc  b086              SUB      sp,sp,#0x18           ;273
0000ce  2400              MOVS     r4,#0
;;;279        num = 0;
0000d0  64ac              STR      r4,[r5,#0x48]  ; size
;;;280        growby = 0;
0000d2  64ec              STR      r4,[r5,#0x4c]  ; num
;;;281        
;;;282        InitDhcpOption(34,1);DumpDhcpOption("option init");
0000d4  2101              MOVS     r1,#1
0000d6  2022              MOVS     r0,#0x22
0000d8  652c              STR      r4,[r5,#0x50]  ; growby
0000da  f7fffffe          BL       InitDhcpOption
0000de  a0d3              ADR      r0,|L1.1068|
0000e0  f7fffffe          BL       DumpDhcpOption
;;;283        
;;;284        AppendDhcpOption(DHCP6_SOLICIT);
0000e4  2001              MOVS     r0,#1
0000e6  f7fffffe          BL       AppendDhcpOption
;;;285        AppendDhcpOption((uint8_t)((DHCP_XID & 0x00FF0000) >> 16));
0000ea  6a68              LDR      r0,[r5,#0x24]  ; DHCP_XID
0000ec  f3c04007          UBFX     r0,r0,#16,#8
0000f0  f7fffffe          BL       AppendDhcpOption
;;;286        AppendDhcpOption((uint8_t)((DHCP_XID & 0x00FF0000) >> 8));
0000f4  2000              MOVS     r0,#0
0000f6  f7fffffe          BL       AppendDhcpOption
;;;287        AppendDhcpOption((uint8_t)((DHCP_XID & 0x00FF0000) >> 0));DumpDhcpOption("Type&XID");
0000fa  2000              MOVS     r0,#0
0000fc  f7fffffe          BL       AppendDhcpOption
000100  a0cd              ADR      r0,|L1.1080|
000102  f7fffffe          BL       DumpDhcpOption
;;;288    	
;;;289        // Elapsed time   
;;;290    //    AppendDhcpOption(0x00);AppendDhcpOption(OPT_ELAPSED_TIME);
;;;291    //    AppendDhcpOption(0x00);AppendDhcpOption(0x02);
;;;292    //    AppendDhcpOption(0x0c);AppendDhcpOption(0x1c);DumpDhcpOption("Option Elapsed Time");
;;;293        
;;;294        // Client Identifier
;;;295        AppendDhcpOption(0x00);AppendDhcpOption(OPT_CLIENTID);
000106  2000              MOVS     r0,#0
000108  f7fffffe          BL       AppendDhcpOption
00010c  2001              MOVS     r0,#1
00010e  f7fffffe          BL       AppendDhcpOption
;;;296        AppendDhcpOption(0x00);AppendDhcpOption(0x0a); //length
000112  2000              MOVS     r0,#0
000114  f7fffffe          BL       AppendDhcpOption
000118  200a              MOVS     r0,#0xa
00011a  f7fffffe          BL       AppendDhcpOption
;;;297        AppendDhcpOption(0x00);AppendDhcpOption(0x03); //DUID_Type
00011e  2000              MOVS     r0,#0
000120  f7fffffe          BL       AppendDhcpOption
000124  2003              MOVS     r0,#3
000126  f7fffffe          BL       AppendDhcpOption
;;;298        AppendDhcpOption(0x00);AppendDhcpOption(0x01); //Hard_Type
00012a  2000              MOVS     r0,#0
00012c  f7fffffe          BL       AppendDhcpOption
000130  2001              MOVS     r0,#1
000132  f7fffffe          BL       AppendDhcpOption
;;;299        AppendDhcpOption(DHCP_CHADDR[0]);AppendDhcpOption(DHCP_CHADDR[1]); // MAC Addr
000136  f1050654          ADD      r6,r5,#0x54
00013a  7830              LDRB     r0,[r6,#0]  ; DHCP_CHADDR
00013c  f7fffffe          BL       AppendDhcpOption
000140  7870              LDRB     r0,[r6,#1]  ; DHCP_CHADDR
000142  f7fffffe          BL       AppendDhcpOption
;;;300        AppendDhcpOption(DHCP_CHADDR[2]);AppendDhcpOption(DHCP_CHADDR[3]);
000146  78b0              LDRB     r0,[r6,#2]  ; DHCP_CHADDR
000148  f7fffffe          BL       AppendDhcpOption
00014c  78f0              LDRB     r0,[r6,#3]  ; DHCP_CHADDR
00014e  f7fffffe          BL       AppendDhcpOption
;;;301        AppendDhcpOption(DHCP_CHADDR[4]);AppendDhcpOption(DHCP_CHADDR[5]);DumpDhcpOption("Option Client ID");
000152  7930              LDRB     r0,[r6,#4]  ; DHCP_CHADDR
000154  f7fffffe          BL       AppendDhcpOption
000158  7970              LDRB     r0,[r6,#5]  ; DHCP_CHADDR
00015a  f7fffffe          BL       AppendDhcpOption
00015e  a0b9              ADR      r0,|L1.1092|
000160  f7fffffe          BL       DumpDhcpOption
;;;302    	
;;;303    	// Identity Association for Non-temporary Address
;;;304    	AppendDhcpOption(0x00);AppendDhcpOption(OPT_IANA);
000164  2000              MOVS     r0,#0
000166  f7fffffe          BL       AppendDhcpOption
00016a  2003              MOVS     r0,#3
00016c  f7fffffe          BL       AppendDhcpOption
;;;305        AppendDhcpOption(0x00);AppendDhcpOption(0x0c); // length
000170  2000              MOVS     r0,#0
000172  f7fffffe          BL       AppendDhcpOption
000176  200c              MOVS     r0,#0xc
000178  f7fffffe          BL       AppendDhcpOption
;;;306        AppendDhcpOption(0x03);AppendDhcpOption(0x00); // IAID
00017c  2003              MOVS     r0,#3
00017e  f7fffffe          BL       AppendDhcpOption
000182  2000              MOVS     r0,#0
000184  f7fffffe          BL       AppendDhcpOption
;;;307        AppendDhcpOption(0x08);AppendDhcpOption(0xdc);
000188  2008              MOVS     r0,#8
00018a  f7fffffe          BL       AppendDhcpOption
00018e  20dc              MOVS     r0,#0xdc
000190  f7fffffe          BL       AppendDhcpOption
;;;308        AppendDhcpOption(0x00);AppendDhcpOption(0x00); // T1
000194  2000              MOVS     r0,#0
000196  f7fffffe          BL       AppendDhcpOption
00019a  2000              MOVS     r0,#0
00019c  f7fffffe          BL       AppendDhcpOption
;;;309        AppendDhcpOption(0x00);AppendDhcpOption(0x00);
0001a0  2000              MOVS     r0,#0
0001a2  f7fffffe          BL       AppendDhcpOption
0001a6  2000              MOVS     r0,#0
0001a8  f7fffffe          BL       AppendDhcpOption
;;;310        AppendDhcpOption(0x00);AppendDhcpOption(0x00); // T2
0001ac  2000              MOVS     r0,#0
0001ae  f7fffffe          BL       AppendDhcpOption
0001b2  2000              MOVS     r0,#0
0001b4  f7fffffe          BL       AppendDhcpOption
;;;311        AppendDhcpOption(0x00);AppendDhcpOption(0x00);DumpDhcpOption("Option IANA");
0001b8  2000              MOVS     r0,#0
0001ba  f7fffffe          BL       AppendDhcpOption
0001be  2000              MOVS     r0,#0
0001c0  f7fffffe          BL       AppendDhcpOption
0001c4  a0a4              ADR      r0,|L1.1112|
0001c6  f7fffffe          BL       DumpDhcpOption
;;;312        
;;;313        // Fully Qualified Domain Name
;;;314    //    AppendDhcpOption(0x00);AppendDhcpOption(39);
;;;315    //    AppendDhcpOption(0x00);AppendDhcpOption(0x06); // length
;;;316    //    AppendDhcpOption(0x00);AppendDhcpOption(0x04);
;;;317    //    AppendDhcpOption(0x44);AppendDhcpOption(0x45);
;;;318    //    AppendDhcpOption(0x44);AppendDhcpOption(0x59);DumpDhcpOption("Option FQ Domain Name");
;;;319    
;;;320        // Vendor Class
;;;321    //    AppendDhcpOption(0x00);AppendDhcpOption(16);
;;;322    //    AppendDhcpOption(0x00);AppendDhcpOption(0x0e); // length
;;;323    //    AppendDhcpOption(0x00);AppendDhcpOption(0x00);
;;;324    //    AppendDhcpOption(0x01);AppendDhcpOption(0x37);
;;;325    //    AppendDhcpOption(0x00);AppendDhcpOption(0x08);
;;;326    //    AppendDhcpOption(0x4d);AppendDhcpOption(0x53);
;;;327    //    AppendDhcpOption(0x46);AppendDhcpOption(0x54);
;;;328    //    AppendDhcpOption(0x20);AppendDhcpOption(0x35);
;;;329    //    AppendDhcpOption(0x2e);AppendDhcpOption(0x30);DumpDhcpOption("Option Vendor Class");
;;;330    	    
;;;331        // Option Request
;;;332    //    AppendDhcpOption(0x00);AppendDhcpOption(OPT_REQUEST);
;;;333    //    AppendDhcpOption(0x00);AppendDhcpOption(0x08); // length
;;;334    //    AppendDhcpOption(0x00);AppendDhcpOption(OPT_VENDOR_OPTS);
;;;335    //    AppendDhcpOption(0x00);AppendDhcpOption(DNS_RecursiveNameServer);
;;;336    //    AppendDhcpOption(0x00);AppendDhcpOption(Domain_Search_List);
;;;337    //    AppendDhcpOption(0x00);AppendDhcpOption(FQ_DOMAIN_NAME);DumpDhcpOption("Option Request");
;;;338    
;;;339    	// send broadcasting packet
;;;340    	ip[ 0] = 0xff; ip[ 1] = 0x02;
0001ca  20ff              MOVS     r0,#0xff
0001cc  f88d0008          STRB     r0,[sp,#8]
0001d0  2202              MOVS     r2,#2
0001d2  f88d2009          STRB     r2,[sp,#9]
;;;341    	
;;;342        for(j=2; j<13; j++)
0001d6  4610              MOV      r0,r2
0001d8  a902              ADD      r1,sp,#8              ;275
                  |L1.474|
;;;343            ip[ j] = 0x00;
0001da  540c              STRB     r4,[r1,r0]
0001dc  1c40              ADDS     r0,r0,#1
0001de  b280              UXTH     r0,r0                 ;342
0001e0  280d              CMP      r0,#0xd               ;342
0001e2  d3fa              BCC      |L1.474|
;;;344            
;;;345    	ip[13] = 0x01; ip[14] = 0x00;	ip[15] = 0x02;
0001e4  2001              MOVS     r0,#1
0001e6  f88d0015          STRB     r0,[sp,#0x15]
0001ea  f88d4016          STRB     r4,[sp,#0x16]
0001ee  f88d2017          STRB     r2,[sp,#0x17]
;;;346        
;;;347        rip_msg_size  = size;
0001f2  f8952048          LDRB     r2,[r5,#0x48]  ; size
;;;348        
;;;349    #ifdef _DHCP_DEBUG_
;;;350    	printf("> Send DHCP_DISCOVER\r\n");
;;;351    #endif
;;;352            
;;;353    	sendto(DHCP_SOCKET, (uint8_t*)pDHCPMSG.OPT, rip_msg_size, ip, DHCP_SERVER_PORT, 16);
0001f6  2110              MOVS     r1,#0x10
0001f8  f2402023          MOV      r0,#0x223
0001fc  e9cd0100          STRD     r0,r1,[sp,#0]
000200  487e              LDR      r0,|L1.1020|
000202  ab02              ADD      r3,sp,#8
000204  3028              ADDS     r0,r0,#0x28
000206  6801              LDR      r1,[r0,#0]  ; pDHCPMSG
000208  78a8              LDRB     r0,[r5,#2]  ; DHCP_SOCKET
00020a  f7fffffe          BL       sendto
;;;354        
;;;355    #ifdef _DHCP_DEBUG_
;;;356    	printf("> %d, %d\r\n", ret, rip_msg_size);
;;;357    #endif
;;;358        UnInitDhcpOption();
00020e  f7fffffe          BL       UnInitDhcpOption
;;;359        
;;;360        //return ret
;;;361    }
000212  b006              ADD      sp,sp,#0x18
000214  bd70              POP      {r4-r6,pc}
;;;362    
                          ENDP

                  send_DHCP_REQUEST PROC
;;;363    /* SEND DHCPv6 REQUEST */
;;;364    uint8_t send_DHCP_REQUEST(void)
000216  e92d41f0          PUSH     {r4-r8,lr}
;;;365    {
;;;366    	//uint16_t i;
;;;367    	uint16_t j;
;;;368    	uint8_t ip[16];
;;;369        uint8_t rip_msg_size;
;;;370        uint8_t ret=1;
;;;371    	
;;;372        size = 0;
00021a  4d78              LDR      r5,|L1.1020|
00021c  b092              SUB      sp,sp,#0x48           ;365
00021e  2700              MOVS     r7,#0
;;;373        num = 0;
000220  64af              STR      r7,[r5,#0x48]  ; size
;;;374        growby = 0; 
000222  64ef              STR      r7,[r5,#0x4c]  ; num
;;;375    	
;;;376    	if(iana_len == 0)
000224  652f              STR      r7,[r5,#0x50]  ; growby
000226  8968              LDRH     r0,[r5,#0xa]  ; iana_len
000228  f04f0801          MOV      r8,#1                 ;370
00022c  2800              CMP      r0,#0
00022e  d07c              BEQ      |L1.810|
;;;377    	{
;;;378    		return 9;
;;;379    	}
;;;380        printf("req : %x%x:%x%x:%x%x:%x%x:%x%x:%x%x:%x%x:%x%x \r\n",recv_IP[0],recv_IP[1],recv_IP[2],recv_IP[3],recv_IP[4],recv_IP[5],recv_IP[6],recv_IP[7],recv_IP[8],recv_IP[9],recv_IP[10],recv_IP[11],recv_IP[12],recv_IP[13],recv_IP[14],recv_IP[15]);
000230  4c8c              LDR      r4,|L1.1124|
000232  ae09              ADD      r6,sp,#0x24
000234  7b20              LDRB     r0,[r4,#0xc]  ; recv_IP
000236  7be3              LDRB     r3,[r4,#0xf]  ; recv_IP
000238  7ba2              LDRB     r2,[r4,#0xe]  ; recv_IP
00023a  7b61              LDRB     r1,[r4,#0xd]  ; recv_IP
00023c  e886000f          STM      r6,{r0-r3}
000240  7a20              LDRB     r0,[r4,#8]  ; recv_IP
000242  ae05              ADD      r6,sp,#0x14
000244  7ae3              LDRB     r3,[r4,#0xb]  ; recv_IP
000246  7aa2              LDRB     r2,[r4,#0xa]  ; recv_IP
000248  7a61              LDRB     r1,[r4,#9]  ; recv_IP
00024a  e886000f          STM      r6,{r0-r3}
00024e  7920              LDRB     r0,[r4,#4]  ; recv_IP
000250  ae01              ADD      r6,sp,#4
000252  79e3              LDRB     r3,[r4,#7]  ; recv_IP
000254  79a2              LDRB     r2,[r4,#6]  ; recv_IP
000256  7961              LDRB     r1,[r4,#5]  ; recv_IP
000258  e886000f          STM      r6,{r0-r3}
00025c  78e0              LDRB     r0,[r4,#3]  ; recv_IP
00025e  9000              STR      r0,[sp,#0]
000260  78a3              LDRB     r3,[r4,#2]  ; recv_IP
000262  7862              LDRB     r2,[r4,#1]  ; recv_IP
000264  7821              LDRB     r1,[r4,#0]  ; recv_IP
000266  a080              ADR      r0,|L1.1128|
000268  f7fffffe          BL       __2printf
;;;381        InitDhcpOption(60,1);DumpDhcpOption("option init");
00026c  2101              MOVS     r1,#1
00026e  203c              MOVS     r0,#0x3c
000270  f7fffffe          BL       InitDhcpOption
000274  a06d              ADR      r0,|L1.1068|
000276  f7fffffe          BL       DumpDhcpOption
;;;382        
;;;383        AppendDhcpOption(DHCP6_REQUEST);
00027a  2003              MOVS     r0,#3
00027c  f7fffffe          BL       AppendDhcpOption
;;;384        AppendDhcpOption((uint8_t)((DHCP_XID & 0x00FF0000) >> 16));
000280  6a68              LDR      r0,[r5,#0x24]  ; DHCP_XID
000282  f3c04007          UBFX     r0,r0,#16,#8
000286  f7fffffe          BL       AppendDhcpOption
;;;385        AppendDhcpOption((uint8_t)((DHCP_XID & 0x0000FF00) >> 8));
00028a  8ca8              LDRH     r0,[r5,#0x24]  ; DHCP_XID
00028c  f3c02007          UBFX     r0,r0,#8,#8
000290  f7fffffe          BL       AppendDhcpOption
;;;386        AppendDhcpOption((uint8_t)((DHCP_XID & 0x000000FF) >> 0));DumpDhcpOption("Type&XID");
000294  f8950024          LDRB     r0,[r5,#0x24]  ; DHCP_XID
000298  f7fffffe          BL       AppendDhcpOption
00029c  a066              ADR      r0,|L1.1080|
00029e  f7fffffe          BL       DumpDhcpOption
;;;387    	
;;;388        // Elapsed time   
;;;389        //AppendDhcpOption(0x00);AppendDhcpOption(OPT_ELAPSED_TIME);
;;;390        //AppendDhcpOption(0x00);AppendDhcpOption(0x02);
;;;391        //AppendDhcpOption(0x0c);AppendDhcpOption(0x1c);DumpDhcpOption("Option Elapsed Time");
;;;392    
;;;393    	// Identity Association for Non-temporary Address
;;;394    	AppendDhcpOption(0x00);AppendDhcpOption(OPT_IANA);
0002a2  2000              MOVS     r0,#0
0002a4  f7fffffe          BL       AppendDhcpOption
0002a8  2003              MOVS     r0,#3
0002aa  f7fffffe          BL       AppendDhcpOption
;;;395        AppendDhcpOption((uint8_t)(iana_len>>8));AppendDhcpOption((uint8_t)iana_len); // length
0002ae  8968              LDRH     r0,[r5,#0xa]  ; iana_len
0002b0  0a00              LSRS     r0,r0,#8
0002b2  f7fffffe          BL       AppendDhcpOption
0002b6  7aa8              LDRB     r0,[r5,#0xa]  ; iana_len
0002b8  f7fffffe          BL       AppendDhcpOption
;;;396        AppendDhcpOption(IAID[0]);AppendDhcpOption(IAID[1]); // IAID
0002bc  f105063c          ADD      r6,r5,#0x3c
0002c0  7830              LDRB     r0,[r6,#0]  ; IAID
0002c2  f7fffffe          BL       AppendDhcpOption
0002c6  7870              LDRB     r0,[r6,#1]  ; IAID
0002c8  f7fffffe          BL       AppendDhcpOption
;;;397        AppendDhcpOption(IAID[2]);AppendDhcpOption(IAID[3]);
0002cc  78b0              LDRB     r0,[r6,#2]  ; IAID
0002ce  f7fffffe          BL       AppendDhcpOption
0002d2  78f0              LDRB     r0,[r6,#3]  ; IAID
0002d4  f7fffffe          BL       AppendDhcpOption
;;;398        AppendDhcpOption(T1[0]);AppendDhcpOption(T1[1]); // T1
0002d8  1d36              ADDS     r6,r6,#4
0002da  7830              LDRB     r0,[r6,#0]  ; T1
0002dc  f7fffffe          BL       AppendDhcpOption
0002e0  7870              LDRB     r0,[r6,#1]  ; T1
0002e2  f7fffffe          BL       AppendDhcpOption
;;;399        AppendDhcpOption(T1[2]);AppendDhcpOption(T1[3]);
0002e6  78b0              LDRB     r0,[r6,#2]  ; T1
0002e8  f7fffffe          BL       AppendDhcpOption
0002ec  78f0              LDRB     r0,[r6,#3]  ; T1
0002ee  f7fffffe          BL       AppendDhcpOption
;;;400        AppendDhcpOption(T2[0]);AppendDhcpOption(T2[1]); // T2
0002f2  1d36              ADDS     r6,r6,#4
0002f4  7830              LDRB     r0,[r6,#0]  ; T2
0002f6  f7fffffe          BL       AppendDhcpOption
0002fa  7870              LDRB     r0,[r6,#1]  ; T2
0002fc  f7fffffe          BL       AppendDhcpOption
;;;401        AppendDhcpOption(T2[2]);AppendDhcpOption(T2[3]);DumpDhcpOption("Option IANA");
000300  78b0              LDRB     r0,[r6,#2]  ; T2
000302  f7fffffe          BL       AppendDhcpOption
000306  78f0              LDRB     r0,[r6,#3]  ; T2
000308  f7fffffe          BL       AppendDhcpOption
00030c  a052              ADR      r0,|L1.1112|
00030e  f7fffffe          BL       DumpDhcpOption
;;;402        
;;;403        // IA Address
;;;404        AppendDhcpOption(0x00);AppendDhcpOption(OPT_IAADDR);
000312  2000              MOVS     r0,#0
000314  f7fffffe          BL       AppendDhcpOption
000318  2005              MOVS     r0,#5
00031a  f7fffffe          BL       AppendDhcpOption
;;;405        AppendDhcpOption((uint8_t)(iaaddr_len>>8));AppendDhcpOption((uint8_t)iaaddr_len); // length
00031e  89a8              LDRH     r0,[r5,#0xc]  ; iaaddr_len
000320  0a00              LSRS     r0,r0,#8
000322  f7fffffe          BL       AppendDhcpOption
000326  7b28              LDRB     r0,[r5,#0xc]  ; iaaddr_len
000328  e000              B        |L1.812|
                  |L1.810|
00032a  e139              B        |L1.1440|
                  |L1.812|
00032c  f7fffffe          BL       AppendDhcpOption
;;;406        AppendDhcpOption(recv_IP[ 0]);AppendDhcpOption(recv_IP[ 1]); // IP
000330  7820              LDRB     r0,[r4,#0]  ; recv_IP
000332  f7fffffe          BL       AppendDhcpOption
000336  7860              LDRB     r0,[r4,#1]  ; recv_IP
000338  f7fffffe          BL       AppendDhcpOption
;;;407        AppendDhcpOption(recv_IP[ 2]);AppendDhcpOption(recv_IP[ 3]);
00033c  78a0              LDRB     r0,[r4,#2]  ; recv_IP
00033e  f7fffffe          BL       AppendDhcpOption
000342  78e0              LDRB     r0,[r4,#3]  ; recv_IP
000344  f7fffffe          BL       AppendDhcpOption
;;;408        AppendDhcpOption(recv_IP[ 4]);AppendDhcpOption(recv_IP[ 5]);
000348  7920              LDRB     r0,[r4,#4]  ; recv_IP
00034a  f7fffffe          BL       AppendDhcpOption
00034e  7960              LDRB     r0,[r4,#5]  ; recv_IP
000350  f7fffffe          BL       AppendDhcpOption
;;;409        AppendDhcpOption(recv_IP[ 6]);AppendDhcpOption(recv_IP[ 7]);
000354  79a0              LDRB     r0,[r4,#6]  ; recv_IP
000356  f7fffffe          BL       AppendDhcpOption
00035a  79e0              LDRB     r0,[r4,#7]  ; recv_IP
00035c  f7fffffe          BL       AppendDhcpOption
;;;410        AppendDhcpOption(recv_IP[ 8]);AppendDhcpOption(recv_IP[ 9]);
000360  7a20              LDRB     r0,[r4,#8]  ; recv_IP
000362  f7fffffe          BL       AppendDhcpOption
000366  7a60              LDRB     r0,[r4,#9]  ; recv_IP
000368  f7fffffe          BL       AppendDhcpOption
;;;411        AppendDhcpOption(recv_IP[10]);AppendDhcpOption(recv_IP[11]);
00036c  7aa0              LDRB     r0,[r4,#0xa]  ; recv_IP
00036e  f7fffffe          BL       AppendDhcpOption
000372  7ae0              LDRB     r0,[r4,#0xb]  ; recv_IP
000374  f7fffffe          BL       AppendDhcpOption
;;;412        AppendDhcpOption(recv_IP[12]);AppendDhcpOption(recv_IP[13]);
000378  7b20              LDRB     r0,[r4,#0xc]  ; recv_IP
00037a  f7fffffe          BL       AppendDhcpOption
00037e  7b60              LDRB     r0,[r4,#0xd]  ; recv_IP
000380  f7fffffe          BL       AppendDhcpOption
;;;413        AppendDhcpOption(recv_IP[14]);AppendDhcpOption(recv_IP[15]);
000384  7ba0              LDRB     r0,[r4,#0xe]  ; recv_IP
000386  f7fffffe          BL       AppendDhcpOption
00038a  7be0              LDRB     r0,[r4,#0xf]  ; recv_IP
00038c  f7fffffe          BL       AppendDhcpOption
;;;414        AppendDhcpOption((uint8_t)(PreLifeTime>>24));AppendDhcpOption((uint8_t)(PreLifeTime>>16));
000390  6b68              LDR      r0,[r5,#0x34]  ; PreLifeTime
000392  0e00              LSRS     r0,r0,#24
000394  f7fffffe          BL       AppendDhcpOption
000398  6b68              LDR      r0,[r5,#0x34]  ; PreLifeTime
00039a  f3c04007          UBFX     r0,r0,#16,#8
00039e  f7fffffe          BL       AppendDhcpOption
;;;415        AppendDhcpOption((uint8_t)(PreLifeTime>>8));AppendDhcpOption((uint8_t)PreLifeTime);
0003a2  8ea8              LDRH     r0,[r5,#0x34]  ; PreLifeTime
0003a4  f3c02007          UBFX     r0,r0,#8,#8
0003a8  f7fffffe          BL       AppendDhcpOption
0003ac  f8950034          LDRB     r0,[r5,#0x34]  ; PreLifeTime
0003b0  f7fffffe          BL       AppendDhcpOption
;;;416        AppendDhcpOption((uint8_t)(ValidLifeTime>>24));AppendDhcpOption((uint8_t)(ValidLifeTime>>16));
0003b4  6ba8              LDR      r0,[r5,#0x38]  ; ValidLifeTime
0003b6  0e00              LSRS     r0,r0,#24
0003b8  f7fffffe          BL       AppendDhcpOption
0003bc  6ba8              LDR      r0,[r5,#0x38]  ; ValidLifeTime
0003be  f3c04007          UBFX     r0,r0,#16,#8
0003c2  f7fffffe          BL       AppendDhcpOption
;;;417        AppendDhcpOption((uint8_t)(ValidLifeTime>>8));AppendDhcpOption((uint8_t)ValidLifeTime);DumpDhcpOption("Option IA_addr");
0003c6  8f28              LDRH     r0,[r5,#0x38]  ; ValidLifeTime
0003c8  f3c02007          UBFX     r0,r0,#8,#8
0003cc  f7fffffe          BL       AppendDhcpOption
0003d0  f8950038          LDRB     r0,[r5,#0x38]  ; ValidLifeTime
0003d4  f7fffffe          BL       AppendDhcpOption
0003d8  a030              ADR      r0,|L1.1180|
0003da  f7fffffe          BL       DumpDhcpOption
;;;418            
;;;419        // Status code
;;;420        //AppendDhcpOption(0x00);AppendDhcpOption(OPT_STATUS_CODE);DumpDhcpOption("Option status_code type");
;;;421        //AppendDhcpOption((uint8_t)(Lstatuscode_len>>8));AppendDhcpOption((uint8_t)Lstatuscode_len); DumpDhcpOption("Option status_code length");// length
;;;422        //AppendDhcpOption((uint8_t)(code>>8));AppendDhcpOption((uint8_t)code); DumpDhcpOption("Option status_code code");// code
;;;423    //    for(i=0; i<(statuscode_len-2); i++)
;;;424    //        AppendDhcpOption(status_msg[i]);
;;;425    //    DumpDhcpOption("Option status_code msg");
;;;426            
;;;427    //    AppendDhcpOption(0x41);AppendDhcpOption(0x73);
;;;428    //    AppendDhcpOption(0x73);AppendDhcpOption(0x69);
;;;429    //    AppendDhcpOption(0x67);AppendDhcpOption(0x6e);
;;;430    //    AppendDhcpOption(0x65);AppendDhcpOption(0x64);
;;;431    //    AppendDhcpOption(0x20);AppendDhcpOption(0x61);
;;;432    //    AppendDhcpOption(0x6e);AppendDhcpOption(0x20);
;;;433    //    AppendDhcpOption(0x61);AppendDhcpOption(0x64);
;;;434    //    AppendDhcpOption(0x64);AppendDhcpOption(0x72);
;;;435    //    AppendDhcpOption(0x65);AppendDhcpOption(0x73);
;;;436    //    AppendDhcpOption(0x73);AppendDhcpOption(0x2e); 
;;;437        
;;;438        // Client Identifier
;;;439        AppendDhcpOption(0x00);AppendDhcpOption(OPT_CLIENTID);
0003de  2000              MOVS     r0,#0
0003e0  f7fffffe          BL       AppendDhcpOption
0003e4  2001              MOVS     r0,#1
0003e6  f7fffffe          BL       AppendDhcpOption
;;;440        AppendDhcpOption(0x00);AppendDhcpOption(0x0a); //length
0003ea  2000              MOVS     r0,#0
0003ec  f7fffffe          BL       AppendDhcpOption
0003f0  200a              MOVS     r0,#0xa
0003f2  f7fffffe          BL       AppendDhcpOption
;;;441        AppendDhcpOption(0x00);AppendDhcpOption(0x03); //DUID_Type
0003f6  2000              MOVS     r0,#0
0003f8  e058              B        |L1.1196|
0003fa  0000              DCW      0x0000
                  |L1.1020|
                          DCD      ||.data||
                  |L1.1024|
000400  25323073          DCB      "%20s => size=%02d,num=%02d : ",0
000404  203d3e20
000408  73697a65
00040c  3d253032
000410  642c6e75
000414  6d3d2530
000418  3264203a
00041c  2000    
00041e  00                DCB      0
00041f  00                DCB      0
                  |L1.1056|
000420  252e3278          DCB      "%.2x ",0
000424  2000    
000426  00                DCB      0
000427  00                DCB      0
                  |L1.1064|
000428  0d0a00            DCB      "\r\n",0
00042b  00                DCB      0
                  |L1.1068|
00042c  6f707469          DCB      "option init",0
000430  6f6e2069
000434  6e697400
                  |L1.1080|
000438  54797065          DCB      "Type&XID",0
00043c  26584944
000440  00      
000441  00                DCB      0
000442  00                DCB      0
000443  00                DCB      0
                  |L1.1092|
000444  4f707469          DCB      "Option Client ID",0
000448  6f6e2043
00044c  6c69656e
000450  74204944
000454  00      
000455  00                DCB      0
000456  00                DCB      0
000457  00                DCB      0
                  |L1.1112|
000458  4f707469          DCB      "Option IANA",0
00045c  6f6e2049
000460  414e4100
                  |L1.1124|
                          DCD      ||.bss||+0x20
                  |L1.1128|
000468  72657120          DCB      "req : %x%x:%x%x:%x%x:%x%x:%x%x:%x%x:%x%x:%x%x \r\n",0
00046c  3a202578
000470  25783a25
000474  7825783a
000478  25782578
00047c  3a257825
000480  783a2578
000484  25783a25
000488  7825783a
00048c  25782578
000490  3a257825
000494  78200d0a
000498  00      
000499  00                DCB      0
00049a  00                DCB      0
00049b  00                DCB      0
                  |L1.1180|
00049c  4f707469          DCB      "Option IA_addr",0
0004a0  6f6e2049
0004a4  415f6164
0004a8  647200  
0004ab  00                DCB      0
                  |L1.1196|
0004ac  f7fffffe          BL       AppendDhcpOption
0004b0  2003              MOVS     r0,#3
0004b2  f7fffffe          BL       AppendDhcpOption
;;;442        AppendDhcpOption(0x00);AppendDhcpOption(0x01); //Hard_Type
0004b6  2000              MOVS     r0,#0
0004b8  f7fffffe          BL       AppendDhcpOption
0004bc  2001              MOVS     r0,#1
0004be  f7fffffe          BL       AppendDhcpOption
;;;443        AppendDhcpOption(DHCP_CHADDR[0]);AppendDhcpOption(DHCP_CHADDR[1]); // MAC Addr
0004c2  f1050454          ADD      r4,r5,#0x54
0004c6  7820              LDRB     r0,[r4,#0]  ; DHCP_CHADDR
0004c8  f7fffffe          BL       AppendDhcpOption
0004cc  7860              LDRB     r0,[r4,#1]  ; DHCP_CHADDR
0004ce  f7fffffe          BL       AppendDhcpOption
;;;444        AppendDhcpOption(DHCP_CHADDR[2]);AppendDhcpOption(DHCP_CHADDR[3]);
0004d2  78a0              LDRB     r0,[r4,#2]  ; DHCP_CHADDR
0004d4  f7fffffe          BL       AppendDhcpOption
0004d8  78e0              LDRB     r0,[r4,#3]  ; DHCP_CHADDR
0004da  f7fffffe          BL       AppendDhcpOption
;;;445        AppendDhcpOption(DHCP_CHADDR[4]);AppendDhcpOption(DHCP_CHADDR[5]);DumpDhcpOption("Option Client ID");
0004de  7920              LDRB     r0,[r4,#4]  ; DHCP_CHADDR
0004e0  f7fffffe          BL       AppendDhcpOption
0004e4  7960              LDRB     r0,[r4,#5]  ; DHCP_CHADDR
0004e6  f7fffffe          BL       AppendDhcpOption
0004ea  f2af00a8          ADR      r0,|L1.1092|
0004ee  f7fffffe          BL       DumpDhcpOption
;;;446    //    AppendDhcpOption(0x00);AppendDhcpOption(OPT_CLIENTID);
;;;447    //    AppendDhcpOption((uint8_t)(clientid_len>>8));AppendDhcpOption((uint8_t)clientid_len); //length
;;;448    //    AppendDhcpOption((uint8_t)(DUID_type>>8));AppendDhcpOption((uint8_t)DUID_type); //DUID_Type
;;;449    //    AppendDhcpOption((uint8_t)(Hardware_type>>8));AppendDhcpOption((uint8_t)Hardware_type); //Hard_Type
;;;450    //    AppendDhcpOption(DHCP_CHADDR[0]);AppendDhcpOption(DHCP_CHADDR[1]); // MAC Addr
;;;451    //    AppendDhcpOption(DHCP_CHADDR[2]);AppendDhcpOption(DHCP_CHADDR[3]);
;;;452    //    AppendDhcpOption(DHCP_CHADDR[4]);AppendDhcpOption(DHCP_CHADDR[5]);DumpDhcpOption("Option Client ID");
;;;453    
;;;454        //Server Identifier
;;;455        AppendDhcpOption(0x00);AppendDhcpOption(OPT_SERVERID);
0004f2  2000              MOVS     r0,#0
0004f4  f7fffffe          BL       AppendDhcpOption
0004f8  2002              MOVS     r0,#2
0004fa  f7fffffe          BL       AppendDhcpOption
;;;456        AppendDhcpOption((uint8_t)(serverid_len>>8));AppendDhcpOption((uint8_t)serverid_len); //length
0004fe  8a68              LDRH     r0,[r5,#0x12]  ; serverid_len
000500  0a00              LSRS     r0,r0,#8
000502  f7fffffe          BL       AppendDhcpOption
000506  7ca8              LDRB     r0,[r5,#0x12]  ; serverid_len
000508  f7fffffe          BL       AppendDhcpOption
;;;457        AppendDhcpOption((uint8_t)(DUID_type_s>>8));AppendDhcpOption((uint8_t)DUID_type_s); //DUID_Type
00050c  88a8              LDRH     r0,[r5,#4]  ; DUID_type_s
00050e  0a00              LSRS     r0,r0,#8
000510  f7fffffe          BL       AppendDhcpOption
000514  7928              LDRB     r0,[r5,#4]  ; DUID_type_s
000516  f7fffffe          BL       AppendDhcpOption
;;;458        AppendDhcpOption((uint8_t)(Hardware_type_s>>8));AppendDhcpOption((uint8_t)Hardware_type_s); //Hard_Type
00051a  88e8              LDRH     r0,[r5,#6]  ; Hardware_type_s
00051c  0a00              LSRS     r0,r0,#8
00051e  f7fffffe          BL       AppendDhcpOption
000522  79a8              LDRB     r0,[r5,#6]  ; Hardware_type_s
000524  f7fffffe          BL       AppendDhcpOption
;;;459        //AppendDhcpOption(Time_s[0]);AppendDhcpOption(Time_s[1]); // Time
;;;460        //AppendDhcpOption(Time_s[2]);AppendDhcpOption(Time_s[3]);
;;;461        AppendDhcpOption(Server_MAC[0]);AppendDhcpOption(Server_MAC[1]); // MAC Addr
000528  1da4              ADDS     r4,r4,#6
00052a  7820              LDRB     r0,[r4,#0]  ; Server_MAC
00052c  f7fffffe          BL       AppendDhcpOption
000530  7860              LDRB     r0,[r4,#1]  ; Server_MAC
000532  f7fffffe          BL       AppendDhcpOption
;;;462        AppendDhcpOption(Server_MAC[2]);AppendDhcpOption(Server_MAC[3]);
000536  78a0              LDRB     r0,[r4,#2]  ; Server_MAC
000538  f7fffffe          BL       AppendDhcpOption
00053c  78e0              LDRB     r0,[r4,#3]  ; Server_MAC
00053e  f7fffffe          BL       AppendDhcpOption
;;;463        AppendDhcpOption(Server_MAC[4]);AppendDhcpOption(Server_MAC[5]);DumpDhcpOption("Option Server ID");
000542  7920              LDRB     r0,[r4,#4]  ; Server_MAC
000544  f7fffffe          BL       AppendDhcpOption
000548  7960              LDRB     r0,[r4,#5]  ; Server_MAC
00054a  f7fffffe          BL       AppendDhcpOption
00054e  a0fd              ADR      r0,|L1.2372|
000550  f7fffffe          BL       DumpDhcpOption
;;;464        
;;;465        // Fully Qualified Domain Name
;;;466    //    AppendDhcpOption(0x00);AppendDhcpOption(39);
;;;467    //    AppendDhcpOption(0x00);AppendDhcpOption(0x06); // length
;;;468    //    AppendDhcpOption(0x00);AppendDhcpOption(0x04);
;;;469    //    AppendDhcpOption(0x44);AppendDhcpOption(0x45);
;;;470    //    AppendDhcpOption(0x44);AppendDhcpOption(0x59);DumpDhcpOption("Option FQ Domain Name");
;;;471    
;;;472        // Vendor Class
;;;473    //    AppendDhcpOption(0x00);AppendDhcpOption(16);
;;;474    //    AppendDhcpOption(0x00);AppendDhcpOption(0x0e); // length
;;;475    //    AppendDhcpOption(0x00);AppendDhcpOption(0x00);
;;;476    //    AppendDhcpOption(0x01);AppendDhcpOption(0x37);
;;;477    //    AppendDhcpOption(0x00);AppendDhcpOption(0x08);
;;;478    //    AppendDhcpOption(0x4d);AppendDhcpOption(0x53);
;;;479    //    AppendDhcpOption(0x46);AppendDhcpOption(0x54);
;;;480    //    AppendDhcpOption(0x20);AppendDhcpOption(0x35);
;;;481    //    AppendDhcpOption(0x2e);AppendDhcpOption(0x30);DumpDhcpOption("Option Vendor Class");
;;;482    	    
;;;483        // Option Request
;;;484    //    AppendDhcpOption(0x00);AppendDhcpOption(OPT_REQUEST);
;;;485    //    AppendDhcpOption(0x00);AppendDhcpOption(0x08); // length
;;;486    //    AppendDhcpOption(0x00);AppendDhcpOption(OPT_VENDOR_OPTS);
;;;487    //    AppendDhcpOption(0x00);AppendDhcpOption(DNS_RecursiveNameServer);
;;;488    //    AppendDhcpOption(0x00);AppendDhcpOption(Domain_Search_List);
;;;489    //    AppendDhcpOption(0x00);AppendDhcpOption(FQ_DOMAIN_NAME);DumpDhcpOption("Option Request");
;;;490    
;;;491    	// send broadcasting packet
;;;492    	ip[ 0] = 0xff; ip[ 1] = 0x02;
000554  20ff              MOVS     r0,#0xff
000556  f88d0034          STRB     r0,[sp,#0x34]
00055a  2202              MOVS     r2,#2
00055c  f88d2035          STRB     r2,[sp,#0x35]
;;;493    	
;;;494        for(j=2; j<13; j++)
000560  4610              MOV      r0,r2
000562  a90d              ADD      r1,sp,#0x34           ;368
                  |L1.1380|
;;;495            ip[ j] = 0x00;
000564  540f              STRB     r7,[r1,r0]
000566  1c40              ADDS     r0,r0,#1
000568  b280              UXTH     r0,r0                 ;494
00056a  280d              CMP      r0,#0xd               ;494
00056c  d3fa              BCC      |L1.1380|
;;;496            
;;;497    	ip[13] = 0x01; ip[14] = 0x00;	ip[15] = 0x02;
00056e  2001              MOVS     r0,#1
000570  f88d0041          STRB     r0,[sp,#0x41]
000574  f88d7042          STRB     r7,[sp,#0x42]
000578  f88d2043          STRB     r2,[sp,#0x43]
;;;498        
;;;499        rip_msg_size  = size;
00057c  f8952048          LDRB     r2,[r5,#0x48]  ; size
;;;500        
;;;501    #ifdef _DHCP_DEBUG_
;;;502    	printf("> Send DHCP_REQUEST\r\n");
;;;503    #endif
;;;504    
;;;505    	sendto(DHCP_SOCKET, (uint8_t*)pDHCPMSG.OPT, rip_msg_size, ip, DHCP_SERVER_PORT, 16);
000580  2110              MOVS     r1,#0x10
000582  f2402023          MOV      r0,#0x223
000586  e9cd0100          STRD     r0,r1,[sp,#0]
00058a  48f3              LDR      r0,|L1.2392|
00058c  ab0d              ADD      r3,sp,#0x34
00058e  6801              LDR      r1,[r0,#0]  ; pDHCPMSG
000590  78a8              LDRB     r0,[r5,#2]  ; DHCP_SOCKET
000592  f7fffffe          BL       sendto
;;;506    #ifdef _DHCP_DEBUG_
;;;507    	printf("> %d, %d\r\n", ret, rip_msg_size);
;;;508    #endif
;;;509        UnInitDhcpOption();
000596  f7fffffe          BL       UnInitDhcpOption
;;;510        
;;;511        return ret;
00059a  4640              MOV      r0,r8
                  |L1.1436|
;;;512    }
00059c  b012              ADD      sp,sp,#0x48
00059e  e55b              B        |L1.88|
                  |L1.1440|
0005a0  2009              MOVS     r0,#9                 ;378
0005a2  e7fb              B        |L1.1436|
;;;513    
                          ENDP

                  send_DHCP_INFOREQ PROC
;;;514    /* SEND DHCPv6 REQUEST */
;;;515    uint8_t send_DHCP_INFOREQ(void)
0005a4  b5f0              PUSH     {r4-r7,lr}
;;;516    {
;;;517    	//uint16_t i;
;;;518    	uint16_t j;
;;;519    	uint8_t ip[16];
;;;520        uint8_t rip_msg_size;
;;;521        uint8_t ret=0;
;;;522    	
;;;523        size = 0;
0005a6  4dec              LDR      r5,|L1.2392|
0005a8  2600              MOVS     r6,#0                 ;521
0005aa  3d28              SUBS     r5,r5,#0x28
0005ac  b087              SUB      sp,sp,#0x1c           ;516
;;;524        num = 0;
0005ae  64ae              STR      r6,[r5,#0x48]  ; size
;;;525        growby = 0; 
0005b0  64ee              STR      r6,[r5,#0x4c]  ; num
0005b2  4634              MOV      r4,r6                 ;523
;;;526    	
;;;527        //printf("req : %x%x:%x%x:%x%x:%x%x:%x%x:%x%x:%x%x:%x%x \r\n",recv_IP[0],recv_IP[1],recv_IP[2],recv_IP[3],recv_IP[4],recv_IP[5],recv_IP[6],recv_IP[7],recv_IP[8],recv_IP[9],recv_IP[10],recv_IP[11],recv_IP[12],recv_IP[13],recv_IP[14],recv_IP[15]);
;;;528        InitDhcpOption(30,1);DumpDhcpOption("option init");
0005b4  2101              MOVS     r1,#1
0005b6  201e              MOVS     r0,#0x1e
0005b8  652e              STR      r6,[r5,#0x50]  ; growby
0005ba  f7fffffe          BL       InitDhcpOption
0005be  f2af1094          ADR      r0,|L1.1068|
0005c2  f7fffffe          BL       DumpDhcpOption
;;;529        
;;;530    	AppendDhcpOption(DHCP6_INFO_REQUEST);
0005c6  200b              MOVS     r0,#0xb
0005c8  f7fffffe          BL       AppendDhcpOption
;;;531        AppendDhcpOption((uint8_t)((DHCP_XID & 0x00FF0000) >> 16));
0005cc  6a68              LDR      r0,[r5,#0x24]  ; DHCP_XID
0005ce  f3c04007          UBFX     r0,r0,#16,#8
0005d2  f7fffffe          BL       AppendDhcpOption
;;;532        AppendDhcpOption((uint8_t)((DHCP_XID & 0x0000FF00) >> 8));
0005d6  8ca8              LDRH     r0,[r5,#0x24]  ; DHCP_XID
0005d8  f3c02007          UBFX     r0,r0,#8,#8
0005dc  f7fffffe          BL       AppendDhcpOption
;;;533        AppendDhcpOption((uint8_t)((DHCP_XID & 0x000000FF) >> 0));DumpDhcpOption("Type&XID");
0005e0  f8950024          LDRB     r0,[r5,#0x24]  ; DHCP_XID
0005e4  f7fffffe          BL       AppendDhcpOption
0005e8  f2af10b4          ADR      r0,|L1.1080|
0005ec  f7fffffe          BL       DumpDhcpOption
;;;534    	
;;;535    //    // Elapsed time   
;;;536    //    AppendDhcpOption(0x00);AppendDhcpOption(OPT_ELAPSED_TIME);
;;;537    //    AppendDhcpOption(0x00);AppendDhcpOption(0x02);
;;;538    //    AppendDhcpOption(0x0c);AppendDhcpOption(0x1c);DumpDhcpOption("Option Elapsed Time");
;;;539        
;;;540        // Client Identifier
;;;541        AppendDhcpOption(0x00);AppendDhcpOption(OPT_CLIENTID);
0005f0  2000              MOVS     r0,#0
0005f2  f7fffffe          BL       AppendDhcpOption
0005f6  2001              MOVS     r0,#1
0005f8  f7fffffe          BL       AppendDhcpOption
;;;542        AppendDhcpOption(0x00);AppendDhcpOption(0x0a); //length
0005fc  2000              MOVS     r0,#0
0005fe  f7fffffe          BL       AppendDhcpOption
000602  200a              MOVS     r0,#0xa
000604  f7fffffe          BL       AppendDhcpOption
;;;543        AppendDhcpOption(0x00);AppendDhcpOption(0x03); //DUID_Type
000608  2000              MOVS     r0,#0
00060a  f7fffffe          BL       AppendDhcpOption
00060e  2003              MOVS     r0,#3
000610  f7fffffe          BL       AppendDhcpOption
;;;544        AppendDhcpOption(0x00);AppendDhcpOption(0x01); //Hard_Type
000614  2000              MOVS     r0,#0
000616  f7fffffe          BL       AppendDhcpOption
00061a  2001              MOVS     r0,#1
00061c  f7fffffe          BL       AppendDhcpOption
;;;545        AppendDhcpOption(DHCP_CHADDR[0]);AppendDhcpOption(DHCP_CHADDR[1]); // MAC Addr
000620  f1050754          ADD      r7,r5,#0x54
000624  7838              LDRB     r0,[r7,#0]  ; DHCP_CHADDR
000626  f7fffffe          BL       AppendDhcpOption
00062a  7878              LDRB     r0,[r7,#1]  ; DHCP_CHADDR
00062c  f7fffffe          BL       AppendDhcpOption
;;;546        AppendDhcpOption(DHCP_CHADDR[2]);AppendDhcpOption(DHCP_CHADDR[3]);
000630  78b8              LDRB     r0,[r7,#2]  ; DHCP_CHADDR
000632  f7fffffe          BL       AppendDhcpOption
000636  78f8              LDRB     r0,[r7,#3]  ; DHCP_CHADDR
000638  f7fffffe          BL       AppendDhcpOption
;;;547        AppendDhcpOption(DHCP_CHADDR[4]);AppendDhcpOption(DHCP_CHADDR[5]);DumpDhcpOption("Option Client ID");
00063c  7938              LDRB     r0,[r7,#4]  ; DHCP_CHADDR
00063e  f7fffffe          BL       AppendDhcpOption
000642  7978              LDRB     r0,[r7,#5]  ; DHCP_CHADDR
000644  f7fffffe          BL       AppendDhcpOption
000648  f2af2008          ADR      r0,|L1.1092|
00064c  f7fffffe          BL       DumpDhcpOption
;;;548    	    
;;;549        // Option Request
;;;550        AppendDhcpOption(0x00);AppendDhcpOption(OPT_REQUEST);
000650  2000              MOVS     r0,#0
000652  f7fffffe          BL       AppendDhcpOption
000656  2006              MOVS     r0,#6
000658  f7fffffe          BL       AppendDhcpOption
;;;551        AppendDhcpOption(0x00);AppendDhcpOption(0x06); // length
00065c  2000              MOVS     r0,#0
00065e  f7fffffe          BL       AppendDhcpOption
000662  2006              MOVS     r0,#6
000664  f7fffffe          BL       AppendDhcpOption
;;;552        //AppendDhcpOption(0x00);AppendDhcpOption(OPT_VENDOR_OPTS);
;;;553        AppendDhcpOption(0x00);AppendDhcpOption(DNS_RecursiveNameServer);
000668  2000              MOVS     r0,#0
00066a  f7fffffe          BL       AppendDhcpOption
00066e  2017              MOVS     r0,#0x17
000670  f7fffffe          BL       AppendDhcpOption
;;;554        AppendDhcpOption(0x00);AppendDhcpOption(Domain_Search_List);
000674  2000              MOVS     r0,#0
000676  f7fffffe          BL       AppendDhcpOption
00067a  2018              MOVS     r0,#0x18
00067c  f7fffffe          BL       AppendDhcpOption
;;;555        AppendDhcpOption(0x00);AppendDhcpOption(OPT_LIFETIME);DumpDhcpOption("Option Request");
000680  2000              MOVS     r0,#0
000682  f7fffffe          BL       AppendDhcpOption
000686  2020              MOVS     r0,#0x20
000688  f7fffffe          BL       AppendDhcpOption
00068c  a0b3              ADR      r0,|L1.2396|
00068e  f7fffffe          BL       DumpDhcpOption
;;;556    
;;;557    	// send broadcasting packet
;;;558    	ip[ 0] = 0xff; ip[ 1] = 0x02;
000692  20ff              MOVS     r0,#0xff
000694  f88d0008          STRB     r0,[sp,#8]
000698  2202              MOVS     r2,#2
00069a  f88d2009          STRB     r2,[sp,#9]
;;;559    	
;;;560        for(j=2; j<13; j++)
00069e  4611              MOV      r1,r2
0006a0  a802              ADD      r0,sp,#8              ;519
                  |L1.1698|
;;;561            ip[ j] = 0x00;
0006a2  5444              STRB     r4,[r0,r1]
0006a4  1c49              ADDS     r1,r1,#1
0006a6  b289              UXTH     r1,r1                 ;560
0006a8  290d              CMP      r1,#0xd               ;560
0006aa  d3fa              BCC      |L1.1698|
;;;562            
;;;563    	ip[13] = 0x01; ip[14] = 0x00;	ip[15] = 0x02;
0006ac  2001              MOVS     r0,#1
0006ae  f88d0015          STRB     r0,[sp,#0x15]
0006b2  f88d4016          STRB     r4,[sp,#0x16]
0006b6  f88d2017          STRB     r2,[sp,#0x17]
;;;564        
;;;565        rip_msg_size  = size;
0006ba  f8952048          LDRB     r2,[r5,#0x48]  ; size
;;;566        
;;;567    #ifdef _DHCP_DEBUG_
;;;568    	printf("> Send DHCP_REQUEST\r\n");
;;;569    #endif
;;;570    
;;;571    	sendto(DHCP_SOCKET, (uint8_t*)pDHCPMSG.OPT, rip_msg_size, ip, DHCP_SERVER_PORT, 16);
0006be  2110              MOVS     r1,#0x10
0006c0  f2402023          MOV      r0,#0x223
0006c4  e9cd0100          STRD     r0,r1,[sp,#0]
0006c8  48a3              LDR      r0,|L1.2392|
0006ca  ab02              ADD      r3,sp,#8
0006cc  6801              LDR      r1,[r0,#0]  ; pDHCPMSG
0006ce  78a8              LDRB     r0,[r5,#2]  ; DHCP_SOCKET
0006d0  f7fffffe          BL       sendto
;;;572        
;;;573    #ifdef _DHCP_DEBUG_
;;;574    	printf("> %d, %d\r\n", ret, rip_msg_size);
;;;575    #endif
;;;576        UnInitDhcpOption();
0006d4  f7fffffe          BL       UnInitDhcpOption
;;;577        
;;;578        return ret;
;;;579    }
0006d8  b007              ADD      sp,sp,#0x1c
0006da  4630              MOV      r0,r6                 ;578
0006dc  bdf0              POP      {r4-r7,pc}
;;;580    
                          ENDP

                  parseDHCPMSG PROC
;;;581    /* PARSE REPLY pDHCPMSG */
;;;582    int8_t parseDHCPMSG(void)
0006de  e92d4ff0          PUSH     {r4-r11,lr}
;;;583    {
;;;584    	uint8_t svr_addr[16];
;;;585    	uint16_t  svr_port;
;;;586        uint8_t addlen;
;;;587    	uint16_t len;
;;;588        uint8_t * p;
;;;589    	uint8_t * e;
;;;590    	uint8_t type, i;
;;;591    	uint16_t opt_len;
;;;592        uint32_t end_point;
;;;593        
;;;594        if((len = getSn_RX_RSR(DHCP_SOCKET)) > 0) {
0006e2  4d9d              LDR      r5,|L1.2392|
0006e4  b09b              SUB      sp,sp,#0x6c           ;583
0006e6  3d28              SUBS     r5,r5,#0x28
0006e8  78a8              LDRB     r0,[r5,#2]  ; DHCP_SOCKET
0006ea  f7fffffe          BL       getSn_RX_RSR
0006ee  0400              LSLS     r0,r0,#16
0006f0  0c00              LSRS     r0,r0,#16
0006f2  d076              BEQ      |L1.2018|
;;;595            len = recvfrom(DHCP_SOCKET, (uint8_t *)pDHCPMSG.OPT, len, svr_addr, (uint16_t*)&svr_port, &addlen);
0006f4  aa19              ADD      r2,sp,#0x64
0006f6  a90f              ADD      r1,sp,#0x3c
0006f8  e9cd1200          STRD     r1,r2,[sp,#0]
0006fc  4c96              LDR      r4,|L1.2392|
0006fe  b202              SXTH     r2,r0
000700  4628              MOV      r0,r5
000702  ab10              ADD      r3,sp,#0x40
000704  7880              LDRB     r0,[r0,#2]  ; DHCP_SOCKET
000706  6821              LDR      r1,[r4,#0]  ; pDHCPMSG
000708  f7fffffe          BL       recvfrom
00070c  b285              UXTH     r5,r0
;;;596            #ifdef _DHCP6_DEBUG_   
;;;597            printf("DHCP message : %.2x%.2x:%.2x%.2x:%.2x%.2x:%.2x%.2x:%.2x%.2x:%.2x%.2x:%.2x%.2x:%.2x%.2x(%d) %d received. \r\n",svr_addr[0],svr_addr[1],svr_addr[2], svr_addr[3],svr_addr[4],svr_addr[5],svr_addr[6], svr_addr[7],svr_addr[8],svr_addr[9],svr_addr[10], svr_addr[11],svr_addr[12],svr_addr[13],svr_addr[14], svr_addr[15],svr_port, len);
00070e  f89d004f          LDRB     r0,[sp,#0x4f]
000712  f89d104e          LDRB     r1,[sp,#0x4e]
000716  ab0c              ADD      r3,sp,#0x30
000718  f8bd203c          LDRH     r2,[sp,#0x3c]
00071c  910b              STR      r1,[sp,#0x2c]
00071e  e8830025          STM      r3,{r0,r2,r5}
000722  f89d004a          LDRB     r0,[sp,#0x4a]
000726  ae07              ADD      r6,sp,#0x1c
000728  f89d304d          LDRB     r3,[sp,#0x4d]
00072c  f89d204c          LDRB     r2,[sp,#0x4c]
000730  f89d104b          LDRB     r1,[sp,#0x4b]
000734  e886000f          STM      r6,{r0-r3}
000738  f89d0046          LDRB     r0,[sp,#0x46]
00073c  ae03              ADD      r6,sp,#0xc
00073e  f89d3049          LDRB     r3,[sp,#0x49]
000742  f89d2048          LDRB     r2,[sp,#0x48]
000746  f89d1047          LDRB     r1,[sp,#0x47]
00074a  e886000f          STM      r6,{r0-r3}
00074e  f89d0043          LDRB     r0,[sp,#0x43]
000752  f89d2045          LDRB     r2,[sp,#0x45]
000756  f89d1044          LDRB     r1,[sp,#0x44]
00075a  e88d0007          STM      sp,{r0-r2}
00075e  f89d3042          LDRB     r3,[sp,#0x42]
000762  f89d2041          LDRB     r2,[sp,#0x41]
000766  f89d1040          LDRB     r1,[sp,#0x40]
00076a  4880              LDR      r0,|L1.2412|
00076c  f7fffffe          BL       __2printf
;;;598            #endif 
;;;599        }
;;;600        else { 
;;;601    		return 0;
;;;602    	}
;;;603       
;;;604    	//if (svr_port == DHCP_SERVER_PORT) {
;;;605            type = 0;
000770  2000              MOVS     r0,#0
;;;606    		p = (uint8_t *)(pDHCPMSG.OPT);
000772  900d              STR      r0,[sp,#0x34]
000774  6824              LDR      r4,[r4,#0]  ; pDHCPMSG
;;;607            e = p + len ;
000776  1960              ADDS     r0,r4,r5
;;;608    		#ifdef _DHCP6_DEBUG_
;;;609            printf("in server port %x\r\n",*p);
000778  9017              STR      r0,[sp,#0x5c]
00077a  7821              LDRB     r1,[r4,#0]
00077c  a07c              ADR      r0,|L1.2416|
00077e  f7fffffe          BL       __2printf
;;;610    		#endif
;;;611            i=0;/*
;;;612            while(p<e){
;;;613            	printf("%.2x ",*p);
;;;614            	i8f(i%16 == 1){
;;;615            		printf("\r\n");
;;;616            	}
;;;617            	p++;i++;
;;;618            }
;;;619            i=0;*/
;;;620            
;;;621            switch ( *p ) {
000782  7821              LDRB     r1,[r4,#0]
000784  2902              CMP      r1,#2
000786  d001              BEQ      |L1.1932|
000788  2907              CMP      r1,#7
00078a  d16f              BNE      |L1.2156|
                  |L1.1932|
;;;622                case DHCP6_ADVERTISE:
;;;623    			case DHCP6_REPLY 	: {
;;;624    				#ifdef _DHCP6_DEBUG_
;;;625                    printf("in ADVER or REPLY(7) type : %x \r\n",*p);
00078c  a07d              ADR      r0,|L1.2436|
00078e  f7fffffe          BL       __2printf
;;;626    				#endif
;;;627                    type = *p++; // type
000792  f8140b04          LDRB     r0,[r4],#4
;;;628                    p++; // xid[0]
;;;629                    p++; // xid[1]
;;;630                    p++; // xid[2]
;;;631                    while ( p < e ) {
000796  900d              STR      r0,[sp,#0x34]
                  |L1.1944|
000798  e229              B        |L1.3054|
                  |L1.1946|
;;;632                        p++;
;;;633                        switch ( *p ) {
00079a  f8140f01          LDRB     r0,[r4,#1]!
00079e  2804              CMP      r0,#4
0007a0  d07e              BEQ      |L1.2208|
0007a2  dc06              BGT      |L1.1970|
0007a4  2801              CMP      r0,#1
0007a6  d00a              BEQ      |L1.1982|
0007a8  2802              CMP      r0,#2
0007aa  d07a              BEQ      |L1.2210|
0007ac  2803              CMP      r0,#3
0007ae  d104              BNE      |L1.1978|
0007b0  e01c              B        |L1.2028|
                  |L1.1970|
0007b2  2817              CMP      r0,#0x17
0007b4  d076              BEQ      |L1.2212|
0007b6  2818              CMP      r0,#0x18
0007b8  d075              BEQ      |L1.2214|
                  |L1.1978|
;;;634                            case OPT_CLIENTID : {
;;;635    							#ifdef _DHCP6_DEBUG_
;;;636                                printf("in clientid \r\n");
;;;637    							#endif
;;;638                                p++;
;;;639                                
;;;640                                opt_len = (*p++<<8);
;;;641                                clientid_len = opt_len + (*p++);
;;;642    							#ifdef _DHCP6_DEBUG_
;;;643                                printf("opt_len : %.4x\r\n", clientid_len);
;;;644    							#endif
;;;645                                end_point = (uint32_t)p + clientid_len;
;;;646                                
;;;647                                while((uint32_t)p != end_point)
;;;648                                {
;;;649                                    p++;
;;;650                                }
;;;651                                break;
;;;652    						}
;;;653                                
;;;654                            case OPT_IANA : {
;;;655    							#ifdef _DHCP6_DEBUG_
;;;656                                printf("in iana \r\n");
;;;657    							#endif
;;;658                                p++;
;;;659                                opt_len = (*p++<<8);
;;;660                                iana_len = opt_len + (*p++);
;;;661                                end_point = (uint32_t)p + iana_len;
;;;662    
;;;663    							//IAID
;;;664                                IAID[0] = *p++; IAID[1] = *p++; IAID[2] = *p++; IAID[3] = *p++;
;;;665    							//T1
;;;666                                T1[0] = *p++; T1[1] = *p++; T1[2] = *p++; T1[3] = *p++;
;;;667    							//T2
;;;668                                T2[0] = *p++; T2[1] = *p++; T2[2] = *p++; T2[3] = *p++;
;;;669                                //IA_NA-options
;;;670                                while((uint32_t)p < end_point)
;;;671                                {
;;;672                                    p++;
;;;673                                    switch(*p)
;;;674                                    {
;;;675                                        case OPT_IAADDR : {
;;;676    										#ifdef _DHCP6_DEBUG_
;;;677                                            printf("in IA addr \r\n");
;;;678    										#endif
;;;679                                            p++;
;;;680                                            opt_len = (*p++<<8);
;;;681                                            iaaddr_len = opt_len + (*p++);
;;;682                                            recv_IP[ 0] = *p++; recv_IP[ 1] = *p++; recv_IP[ 2] = *p++; recv_IP[ 3] = *p++;
;;;683                                            recv_IP[ 4] = *p++; recv_IP[ 5] = *p++; recv_IP[ 6] = *p++; recv_IP[ 7] = *p++;
;;;684                                            recv_IP[ 8] = *p++; recv_IP[ 9] = *p++; recv_IP[10] = *p++; recv_IP[11] = *p++;
;;;685                                            recv_IP[12] = *p++; recv_IP[13] = *p++; recv_IP[14] = *p++; recv_IP[15] = *p++;
;;;686                                            PreLifeTime = (*p++<<24);
;;;687                                            PreLifeTime += (*p++<<16);
;;;688                                            PreLifeTime += (*p++<<8);
;;;689                                            PreLifeTime += (*p++);
;;;690                                            ValidLifeTime = (*p++<<24);
;;;691                                            ValidLifeTime += (*p++<<16);
;;;692                                            ValidLifeTime += (*p++<<8);
;;;693                                            ValidLifeTime += (*p++);
;;;694    										printf("IANA : %.2x%.2x:%.2x%.2x:%.2x%.2x:%.2x%.2x:%.2x%.2x:%.2x%.2x:%.2x%.2x:%.2x%.2x \r\n",recv_IP[0],recv_IP[1],recv_IP[2],recv_IP[3],recv_IP[4],recv_IP[5],recv_IP[6],recv_IP[7],recv_IP[8],recv_IP[9],recv_IP[10],recv_IP[11],recv_IP[12],recv_IP[13],recv_IP[14],recv_IP[15]);
;;;695                                            break;
;;;696    									}
;;;697                                        
;;;698                                        case OPT_STATUS_CODE : {
;;;699    										#ifdef _DHCP6_DEBUG_
;;;700                                            printf("in status code \r\n");
;;;701    										#endif
;;;702                                            p++;
;;;703                                            opt_len = (*p++<<8);
;;;704                                            statuscode_len = opt_len + (*p++);
;;;705                                            Lstatuscode_len = statuscode_len;
;;;706    										#ifdef _DHCP6_DEBUG_
;;;707                                            printf("status_len : %x\r\n", statuscode_len);
;;;708                                            printf("Lstatus_len : %x\r\n", Lstatuscode_len);
;;;709    										#endif
;;;710                                            code = (*p++<<8);
;;;711                                            code = code + (*p++);
;;;712                                            //printf("status_code : %x\r\n", code);
;;;713                                            //for(i=0; i<(statuscode_len-2); i++)
;;;714                                            //    status_msg[i] = *p++;
;;;715                                            //printf("status_msg : %s \r\n", status_msg);
;;;716                                        
;;;717                                            p += statuscode_len-2;
;;;718                                            break;
;;;719    									}
;;;720                                        
;;;721                                        default : {
;;;722    										#ifdef _DHCP6_DEBUG_
;;;723                                            printf("in default \r\n");
;;;724    										#endif
;;;725                                            p++;
;;;726                                            opt_len = (*p++<<8);
;;;727                                            opt_len = opt_len + (*p++);
;;;728                                            p += opt_len;
;;;729                                            break;
;;;730    									}
;;;731                                    }
;;;732                                }
;;;733                                break;
;;;734    						}
;;;735                                
;;;736                            case OPT_IATA : {
;;;737    							#ifdef _DHCP6_DEBUG_
;;;738                                printf("in iata \r\n");
;;;739    							#endif
;;;740                                p++;
;;;741                                opt_len = (*p++<<8);
;;;742                                opt_len = opt_len + (*p++);
;;;743                                //IA_TA-options
;;;744                                p += opt_len;
;;;745                                break;
;;;746    						}
;;;747                            
;;;748                            case OPT_SERVERID : {
;;;749    							#ifdef _DHCP6_DEBUG_
;;;750                                printf("in serverid \r\n");
;;;751    							#endif
;;;752                            
;;;753                                p++;
;;;754                                opt_len = (*p++<<8);
;;;755                                serverid_len = opt_len + (*p++);                        
;;;756                                #ifdef _DHCP6_DEBUG_
;;;757                                printf("opt_len : %.4x\r\n", serverid_len);
;;;758                                #endif
;;;759                                end_point = (uint32_t)p + serverid_len;
;;;760                            
;;;761                                DUID_type_s = (*p++<<8);
;;;762                                DUID_type_s = DUID_type_s + (*p++);
;;;763                                #ifdef _DHCP6_DEBUG_
;;;764                                printf("DUID_type : %.4x\r\n", DUID_type_s);
;;;765    							#endif
;;;766                                if(DUID_type_s == 0x02)
;;;767                                {
;;;768                                    Enterprise_num_s = (*p++<<24);
;;;769                                    Enterprise_num_s = Enterprise_num_s + (*p++<<16);
;;;770                                    Enterprise_num_s = Enterprise_num_s + (*p++<<8);
;;;771                                    Enterprise_num_s = Enterprise_num_s + (*p++);
;;;772                                }
;;;773                                else
;;;774                                {                        
;;;775                                    Hardware_type_s = (*p++<<8);
;;;776                                    Hardware_type_s = Hardware_type_s + (*p++);
;;;777                                    #ifdef _DHCP6_DEBUG_
;;;778                                    printf("Hardware_type : %.4x\r\n", Hardware_type_s);
;;;779    								#endif
;;;780                                }
;;;781                                
;;;782                                if(DUID_type_s == 0x01)
;;;783                                {
;;;784                                    Time_s[0] = *p++;
;;;785                                    Time_s[1] = *p++;
;;;786                                    Time_s[2] = *p++;
;;;787                                    Time_s[3] = *p++;
;;;788                                    #ifdef _DHCP6_DEBUG_
;;;789                                    printf("Time : ");
;;;790                                    for(i=0; i<4; i++)
;;;791                                        printf("%.2x",Time_s[i]);
;;;792                                    printf("\r\n");
;;;793    								#endif
;;;794                                }
;;;795                                //p++;p++;p++;p++;
;;;796                                Server_MAC[0] = *p++;
;;;797                                Server_MAC[1] = *p++;
;;;798                                Server_MAC[2] = *p++;
;;;799                                Server_MAC[3] = *p++;
;;;800                                Server_MAC[4] = *p++;
;;;801                                Server_MAC[5] = *p++;
;;;802    
;;;803    							#ifdef _DHCP6_DEBUG_
;;;804                                printf("Server_MAC : ");
;;;805                                for(i=0; i<6; i++)
;;;806                                    printf("%.2x",Server_MAC[i]);
;;;807                                printf("\r\n");
;;;808    							#endif
;;;809                                while((uint32_t)p != end_point)
;;;810                                {
;;;811                                    p++;
;;;812                                }
;;;813                                break;
;;;814    						}
;;;815    
;;;816                            case DNS_RecursiveNameServer : {
;;;817    							#ifdef _DHCP6_DEBUG_
;;;818                                printf("in DNS Recursive Name Server \r\n");
;;;819    							#endif
;;;820                                p++;
;;;821                                opt_len = (*p++<<8);
;;;822                                opt_len = opt_len + (*p++);
;;;823    						    end_point = (uint32_t)p + opt_len;
;;;824    							
;;;825    							DNS6_Address[ 0] = *p++; DNS6_Address[ 1] = *p++; DNS6_Address[ 2] = *p++; DNS6_Address[ 3] = *p++;
;;;826    							DNS6_Address[ 4] = *p++; DNS6_Address[ 5] = *p++; DNS6_Address[ 6] = *p++; DNS6_Address[ 7] = *p++;
;;;827    							DNS6_Address[ 8] = *p++; DNS6_Address[ 9] = *p++; DNS6_Address[10] = *p++; DNS6_Address[11] = *p++;
;;;828    							DNS6_Address[12] = *p++; DNS6_Address[13] = *p++; DNS6_Address[14] = *p++; DNS6_Address[15] = *p++;
;;;829    
;;;830    							while((uint32_t)p < end_point)
;;;831                                {
;;;832                                    p++;
;;;833                                }
;;;834                            
;;;835                                break;
;;;836    						}
;;;837    						
;;;838    						case Domain_Search_List : {
;;;839    							#ifdef _DHCP6_DEBUG_
;;;840                                printf("in Domain Search List \r\n");
;;;841    							#endif
;;;842                                p++;
;;;843                                opt_len = (*p++<<8);
;;;844                                opt_len = opt_len + (*p++);
;;;845                                end_point = (uint32_t)p + opt_len;
;;;846    							
;;;847    							
;;;848    							
;;;849    							while((uint32_t)p < end_point)
;;;850                                {
;;;851                                    p++;
;;;852                                }
;;;853    							
;;;854    							break;
;;;855    						}
;;;856    						
;;;857                            default : {
;;;858    							#ifdef _DHCP6_DEBUG_
;;;859                                printf("in default \r\n");
0007ba  a07b              ADR      r0,|L1.2472|
;;;860    							#endif
;;;861                                p++;
;;;862                                opt_len = (*p++<<8);
;;;863                                opt_len = opt_len + (*p++);
;;;864                                p += opt_len;
;;;865    //                            end_point = (uint32_t)p + opt_len;
;;;866    
;;;867    //                            while((uint32_t)p != end_point)
;;;868    //                            {
;;;869    //                                printf("still exist option data.\r\n");
;;;870    //                                p++;
;;;871    //                            }
;;;872                                break;
0007bc  e148              B        |L1.2640|
                  |L1.1982|
0007be  a07e              ADR      r0,|L1.2488|
0007c0  f7fffffe          BL       __2printf
0007c4  7860              LDRB     r0,[r4,#1]            ;640
0007c6  78a1              LDRB     r1,[r4,#2]            ;641
0007c8  4d63              LDR      r5,|L1.2392|
0007ca  eb012000          ADD      r0,r1,r0,LSL #8       ;641
0007ce  b281              UXTH     r1,r0                 ;641
0007d0  3d28              SUBS     r5,r5,#0x28           ;641
0007d2  a07d              ADR      r0,|L1.2504|
0007d4  82a9              STRH     r1,[r5,#0x14]         ;641
0007d6  1ce4              ADDS     r4,r4,#3              ;643
0007d8  f7fffffe          BL       __2printf
0007dc  8aa8              LDRH     r0,[r5,#0x14]         ;645  ; clientid_len
0007de  4420              ADD      r0,r0,r4              ;645
0007e0  e001              B        |L1.2022|
                  |L1.2018|
0007e2  e20a              B        |L1.3066|
                  |L1.2020|
0007e4  1c64              ADDS     r4,r4,#1              ;647
                  |L1.2022|
0007e6  4284              CMP      r4,r0                 ;647
0007e8  d0d6              BEQ      |L1.1944|
0007ea  e7fb              B        |L1.2020|
                  |L1.2028|
0007ec  a07b              ADR      r0,|L1.2524|
0007ee  f7fffffe          BL       __2printf
0007f2  7860              LDRB     r0,[r4,#1]            ;659
0007f4  78a1              LDRB     r1,[r4,#2]            ;660
0007f6  1ce4              ADDS     r4,r4,#3              ;660
0007f8  eb012000          ADD      r0,r1,r0,LSL #8       ;660
0007fc  4956              LDR      r1,|L1.2392|
0007fe  b280              UXTH     r0,r0                 ;660
000800  3928              SUBS     r1,r1,#0x28           ;660
000802  8148              STRH     r0,[r1,#0xa]          ;660
000804  4420              ADD      r0,r0,r4              ;661
000806  9016              STR      r0,[sp,#0x58]         ;664
000808  4853              LDR      r0,|L1.2392|
00080a  7821              LDRB     r1,[r4,#0]            ;664
00080c  3014              ADDS     r0,r0,#0x14           ;664
00080e  7001              STRB     r1,[r0,#0]            ;664
000810  7861              LDRB     r1,[r4,#1]            ;664
000812  7041              STRB     r1,[r0,#1]            ;664
000814  78a1              LDRB     r1,[r4,#2]            ;664
000816  7081              STRB     r1,[r0,#2]            ;664
000818  78e1              LDRB     r1,[r4,#3]            ;664
00081a  70c1              STRB     r1,[r0,#3]            ;664
00081c  1d00              ADDS     r0,r0,#4              ;666
00081e  7921              LDRB     r1,[r4,#4]            ;666
000820  7001              STRB     r1,[r0,#0]            ;666
000822  7961              LDRB     r1,[r4,#5]            ;666
000824  7041              STRB     r1,[r0,#1]            ;666
000826  79a1              LDRB     r1,[r4,#6]            ;666
000828  7081              STRB     r1,[r0,#2]            ;666
00082a  79e1              LDRB     r1,[r4,#7]            ;666
00082c  70c1              STRB     r1,[r0,#3]            ;666
00082e  1d00              ADDS     r0,r0,#4              ;668
000830  7a21              LDRB     r1,[r4,#8]            ;668
000832  7001              STRB     r1,[r0,#0]            ;668
000834  7a61              LDRB     r1,[r4,#9]            ;668
000836  7041              STRB     r1,[r0,#1]            ;668
000838  7aa1              LDRB     r1,[r4,#0xa]          ;668
00083a  7081              STRB     r1,[r0,#2]            ;668
00083c  7ae1              LDRB     r1,[r4,#0xb]          ;668
00083e  70c1              STRB     r1,[r0,#3]            ;668
000840  340c              ADDS     r4,r4,#0xc            ;668
000842  e00f              B        |L1.2148|
                  |L1.2116|
000844  f8140f01          LDRB     r0,[r4,#1]!           ;673
000848  2805              CMP      r0,#5                 ;673
00084a  d010              BEQ      |L1.2158|
00084c  280d              CMP      r0,#0xd               ;673
00084e  d078              BEQ      |L1.2370|
000850  a055              ADR      r0,|L1.2472|
000852  f7fffffe          BL       __2printf
000856  7860              LDRB     r0,[r4,#1]            ;726
000858  78a1              LDRB     r1,[r4,#2]            ;727
00085a  1ce4              ADDS     r4,r4,#3              ;727
00085c  eb012000          ADD      r0,r1,r0,LSL #8       ;727
000860  b280              UXTH     r0,r0                 ;727
000862  4404              ADD      r4,r4,r0              ;728
                  |L1.2148|
000864  9816              LDR      r0,[sp,#0x58]         ;670
000866  4284              CMP      r4,r0                 ;670
000868  d296              BCS      |L1.1944|
00086a  e7eb              B        |L1.2116|
                  |L1.2156|
00086c  e1c3              B        |L1.3062|
                  |L1.2158|
00086e  a05e              ADR      r0,|L1.2536|
000870  f7fffffe          BL       __2printf
000874  7860              LDRB     r0,[r4,#1]            ;680
000876  78a1              LDRB     r1,[r4,#2]            ;681
000878  eb012000          ADD      r0,r1,r0,LSL #8       ;681
00087c  4936              LDR      r1,|L1.2392|
00087e  3928              SUBS     r1,r1,#0x28           ;681
000880  8188              STRH     r0,[r1,#0xc]          ;681
000882  485d              LDR      r0,|L1.2552|
000884  78e2              LDRB     r2,[r4,#3]            ;682
000886  7002              STRB     r2,[r0,#0]            ;682
000888  9215              STR      r2,[sp,#0x54]         ;682
00088a  7922              LDRB     r2,[r4,#4]            ;682
00088c  7042              STRB     r2,[r0,#1]            ;682
00088e  9214              STR      r2,[sp,#0x50]         ;682
000890  7962              LDRB     r2,[r4,#5]            ;682
000892  7082              STRB     r2,[r0,#2]            ;682
000894  920e              STR      r2,[sp,#0x38]         ;682
000896  79a2              LDRB     r2,[r4,#6]            ;682
000898  70c2              STRB     r2,[r0,#3]            ;682
00089a  9218              STR      r2,[sp,#0x60]         ;683
00089c  79e2              LDRB     r2,[r4,#7]            ;683
00089e  e003              B        |L1.2216|
                  |L1.2208|
0008a0  e0d5              B        |L1.2638|
                  |L1.2210|
0008a2  e0df              B        |L1.2660|
                  |L1.2212|
0008a4  e164              B        |L1.2928|
                  |L1.2214|
0008a6  e194              B        |L1.3026|
                  |L1.2216|
0008a8  7102              STRB     r2,[r0,#4]            ;683
0008aa  9201              STR      r2,[sp,#4]            ;683
0008ac  7a23              LDRB     r3,[r4,#8]            ;683
0008ae  7143              STRB     r3,[r0,#5]            ;683
0008b0  9300              STR      r3,[sp,#0]            ;683
0008b2  7a65              LDRB     r5,[r4,#9]            ;683
0008b4  7185              STRB     r5,[r0,#6]            ;683
0008b6  7aa6              LDRB     r6,[r4,#0xa]          ;683
0008b8  71c6              STRB     r6,[r0,#7]            ;683
0008ba  7ae2              LDRB     r2,[r4,#0xb]          ;684
0008bc  7202              STRB     r2,[r0,#8]            ;684
0008be  7b23              LDRB     r3,[r4,#0xc]          ;684
0008c0  7243              STRB     r3,[r0,#9]            ;684
0008c2  f894a00d          LDRB     r10,[r4,#0xd]         ;684
0008c6  f880a00a          STRB     r10,[r0,#0xa]         ;684
0008ca  f894c00e          LDRB     r12,[r4,#0xe]         ;684
0008ce  4617              MOV      r7,r2                 ;684
0008d0  f880c00b          STRB     r12,[r0,#0xb]         ;684
0008d4  7be2              LDRB     r2,[r4,#0xf]          ;685
0008d6  4699              MOV      r9,r3                 ;684
0008d8  7302              STRB     r2,[r0,#0xc]          ;685
0008da  7c23              LDRB     r3,[r4,#0x10]         ;685
0008dc  46ae              MOV      lr,r5                 ;683
0008de  7343              STRB     r3,[r0,#0xd]          ;685
0008e0  7c65              LDRB     r5,[r4,#0x11]         ;685
0008e2  46b3              MOV      r11,r6                ;683
0008e4  7385              STRB     r5,[r0,#0xe]          ;685
0008e6  7ca6              LDRB     r6,[r4,#0x12]         ;685
0008e8  73c6              STRB     r6,[r0,#0xf]          ;685
0008ea  7ce0              LDRB     r0,[r4,#0x13]         ;686
0008ec  0600              LSLS     r0,r0,#24             ;686
0008ee  6348              STR      r0,[r1,#0x34]         ;687  ; PreLifeTime
0008f0  f8948014          LDRB     r8,[r4,#0x14]         ;687
0008f4  eb004008          ADD      r0,r0,r8,LSL #16      ;687
0008f8  6348              STR      r0,[r1,#0x34]         ;688  ; PreLifeTime
0008fa  f8948015          LDRB     r8,[r4,#0x15]         ;688
0008fe  eb002008          ADD      r0,r0,r8,LSL #8       ;688
000902  6348              STR      r0,[r1,#0x34]         ;689  ; PreLifeTime
000904  f8948016          LDRB     r8,[r4,#0x16]         ;689
000908  4440              ADD      r0,r0,r8              ;689
00090a  6348              STR      r0,[r1,#0x34]         ;690  ; PreLifeTime
00090c  7de0              LDRB     r0,[r4,#0x17]         ;690
00090e  0600              LSLS     r0,r0,#24             ;690
000910  6388              STR      r0,[r1,#0x38]         ;691  ; ValidLifeTime
000912  f8148f18          LDRB     r8,[r4,#0x18]!        ;691
000916  eb004008          ADD      r0,r0,r8,LSL #16      ;691
00091a  6388              STR      r0,[r1,#0x38]         ;692  ; ValidLifeTime
00091c  f8148f01          LDRB     r8,[r4,#1]!           ;692
000920  eb002008          ADD      r0,r0,r8,LSL #8       ;692
000924  6388              STR      r0,[r1,#0x38]         ;693  ; ValidLifeTime
000926  f8948001          LDRB     r8,[r4,#1]            ;693
00092a  4440              ADD      r0,r0,r8              ;693
00092c  6388              STR      r0,[r1,#0x38]         ;693  ; ValidLifeTime
00092e  a809              ADD      r0,sp,#0x24           ;693
000930  e880006c          STM      r0,{r2,r3,r5,r6}      ;693
000934  a805              ADD      r0,sp,#0x14           ;693
000936  e8801680          STM      r0,{r7,r9,r10,r12}    ;693
00093a  9b00              LDR      r3,[sp,#0]            ;694
00093c  f8cdb010          STR      r11,[sp,#0x10]        ;694
000940  e05c              B        |L1.2556|
                  |L1.2370|
000942  e067              B        |L1.2580|
                  |L1.2372|
000944  4f707469          DCB      "Option Server ID",0
000948  6f6e2053
00094c  65727665
000950  72204944
000954  00      
000955  00                DCB      0
000956  00                DCB      0
000957  00                DCB      0
                  |L1.2392|
                          DCD      ||.data||+0x28
                  |L1.2396|
00095c  4f707469          DCB      "Option Request",0
000960  6f6e2052
000964  65717565
000968  737400  
00096b  00                DCB      0
                  |L1.2412|
                          DCD      ||.conststring||
                  |L1.2416|
000970  696e2073          DCB      "in server port %x\r\n",0
000974  65727665
000978  7220706f
00097c  72742025
000980  780d0a00
                  |L1.2436|
000984  696e2041          DCB      "in ADVER or REPLY(7) type : %x \r\n",0
000988  44564552
00098c  206f7220
000990  5245504c
000994  59283729
000998  20747970
00099c  65203a20
0009a0  2578200d
0009a4  0a00    
0009a6  00                DCB      0
0009a7  00                DCB      0
                  |L1.2472|
0009a8  696e2064          DCB      "in default \r\n",0
0009ac  65666175
0009b0  6c74200d
0009b4  0a00    
0009b6  00                DCB      0
0009b7  00                DCB      0
                  |L1.2488|
0009b8  696e2063          DCB      "in clientid \r\n",0
0009bc  6c69656e
0009c0  74696420
0009c4  0d0a00  
0009c7  00                DCB      0
                  |L1.2504|
0009c8  6f70745f          DCB      "opt_len : %.4x\r\n",0
0009cc  6c656e20
0009d0  3a20252e
0009d4  34780d0a
0009d8  00      
0009d9  00                DCB      0
0009da  00                DCB      0
0009db  00                DCB      0
                  |L1.2524|
0009dc  696e2069          DCB      "in iana \r\n",0
0009e0  616e6120
0009e4  0d0a00  
0009e7  00                DCB      0
                  |L1.2536|
0009e8  696e2049          DCB      "in IA addr \r\n",0
0009ec  41206164
0009f0  6472200d
0009f4  0a00    
0009f6  00                DCB      0
0009f7  00                DCB      0
                  |L1.2552|
                          DCD      ||.bss||+0x20
                  |L1.2556|
0009fc  9a18              LDR      r2,[sp,#0x60]         ;694
0009fe  e9cd3e02          STRD     r3,lr,[sp,#8]         ;694
000a02  9200              STR      r2,[sp,#0]            ;694
000a04  e9dd2114          LDRD     r2,r1,[sp,#0x50]      ;694
000a08  48e8              LDR      r0,|L1.3500|
000a0a  1ca4              ADDS     r4,r4,#2              ;694
000a0c  9b0e              LDR      r3,[sp,#0x38]         ;694
000a0e  f7fffffe          BL       __2printf
000a12  e727              B        |L1.2148|
                  |L1.2580|
000a14  a0e6              ADR      r0,|L1.3504|
000a16  f7fffffe          BL       __2printf
000a1a  7860              LDRB     r0,[r4,#1]            ;703
000a1c  78a1              LDRB     r1,[r4,#2]            ;704
000a1e  4de9              LDR      r5,|L1.3524|
000a20  eb012000          ADD      r0,r1,r0,LSL #8       ;704
000a24  b281              UXTH     r1,r0                 ;704
000a26  81e9              STRH     r1,[r5,#0xe]          ;704
000a28  8229              STRH     r1,[r5,#0x10]         ;705
000a2a  a0e7              ADR      r0,|L1.3528|
000a2c  f7fffffe          BL       __2printf
000a30  8a29              LDRH     r1,[r5,#0x10]         ;708  ; Lstatuscode_len
000a32  a0ea              ADR      r0,|L1.3548|
000a34  f7fffffe          BL       __2printf
000a38  78e0              LDRB     r0,[r4,#3]            ;710
000a3a  0200              LSLS     r0,r0,#8              ;710
000a3c  8128              STRH     r0,[r5,#8]            ;710
000a3e  7921              LDRB     r1,[r4,#4]            ;711
000a40  1d64              ADDS     r4,r4,#5              ;717
000a42  4408              ADD      r0,r0,r1              ;711
000a44  8128              STRH     r0,[r5,#8]            ;711
000a46  89e8              LDRH     r0,[r5,#0xe]          ;717  ; statuscode_len
000a48  4404              ADD      r4,r4,r0              ;717
000a4a  1ea4              SUBS     r4,r4,#2              ;717
000a4c  e70a              B        |L1.2148|
                  |L1.2638|
000a4e  a0e8              ADR      r0,|L1.3568|
                  |L1.2640|
000a50  f7fffffe          BL       __2printf
000a54  7860              LDRB     r0,[r4,#1]            ;862
000a56  78a1              LDRB     r1,[r4,#2]            ;863
000a58  1ce4              ADDS     r4,r4,#3              ;863
000a5a  eb012000          ADD      r0,r1,r0,LSL #8       ;863
000a5e  b280              UXTH     r0,r0                 ;863
000a60  4404              ADD      r4,r4,r0              ;864
000a62  e0c4              B        |L1.3054|
                  |L1.2660|
000a64  a0e5              ADR      r0,|L1.3580|
000a66  f7fffffe          BL       __2printf
000a6a  7860              LDRB     r0,[r4,#1]            ;754
000a6c  78a1              LDRB     r1,[r4,#2]            ;755
000a6e  4ed5              LDR      r6,|L1.3524|
000a70  eb012000          ADD      r0,r1,r0,LSL #8       ;755
000a74  b281              UXTH     r1,r0                 ;755
000a76  8271              STRH     r1,[r6,#0x12]         ;755
000a78  f2af00b4          ADR      r0,|L1.2504|
000a7c  1ce4              ADDS     r4,r4,#3              ;757
000a7e  f7fffffe          BL       __2printf
000a82  8a70              LDRH     r0,[r6,#0x12]         ;759  ; serverid_len
000a84  1825              ADDS     r5,r4,r0              ;759
000a86  f8140b01          LDRB     r0,[r4],#1            ;761
000a8a  0200              LSLS     r0,r0,#8              ;761
000a8c  80b0              STRH     r0,[r6,#4]            ;761
000a8e  f8141b01          LDRB     r1,[r4],#1            ;762
000a92  4408              ADD      r0,r0,r1              ;762
000a94  b281              UXTH     r1,r0                 ;762
000a96  80b1              STRH     r1,[r6,#4]            ;762
000a98  a0dc              ADR      r0,|L1.3596|
000a9a  f7fffffe          BL       __2printf
000a9e  88b0              LDRH     r0,[r6,#4]            ;766  ; DUID_type_s
000aa0  2802              CMP      r0,#2                 ;766
000aa2  f8140b01          LDRB     r0,[r4],#1            ;775
000aa6  d00d              BEQ      |L1.2756|
000aa8  0200              LSLS     r0,r0,#8              ;775
000aaa  80f0              STRH     r0,[r6,#6]            ;775
000aac  f8141b01          LDRB     r1,[r4],#1            ;776
000ab0  4408              ADD      r0,r0,r1              ;776
000ab2  b281              UXTH     r1,r0                 ;776
000ab4  80f1              STRH     r1,[r6,#6]            ;776
000ab6  a0da              ADR      r0,|L1.3616|
000ab8  f7fffffe          BL       __2printf
000abc  88b0              LDRH     r0,[r6,#4]            ;782  ; DUID_type_s
000abe  2801              CMP      r0,#1                 ;782
000ac0  d011              BEQ      |L1.2790|
000ac2  e02d              B        |L1.2848|
                  |L1.2756|
000ac4  0600              LSLS     r0,r0,#24             ;768
000ac6  6330              STR      r0,[r6,#0x30]         ;769  ; Enterprise_num_s
000ac8  f8141b01          LDRB     r1,[r4],#1            ;769
000acc  eb004001          ADD      r0,r0,r1,LSL #16      ;769
000ad0  6330              STR      r0,[r6,#0x30]         ;770  ; Enterprise_num_s
000ad2  f8141b02          LDRB     r1,[r4],#2            ;770
000ad6  eb002001          ADD      r0,r0,r1,LSL #8       ;770
000ada  6330              STR      r0,[r6,#0x30]         ;771  ; Enterprise_num_s
000adc  f8141c01          LDRB     r1,[r4,#-1]           ;771
000ae0  4408              ADD      r0,r0,r1              ;771
000ae2  6330              STR      r0,[r6,#0x30]         ;771  ; Enterprise_num_s
000ae4  e01c              B        |L1.2848|
                  |L1.2790|
000ae6  4fb7              LDR      r7,|L1.3524|
000ae8  f8140b01          LDRB     r0,[r4],#1            ;784
000aec  372c              ADDS     r7,r7,#0x2c           ;784
000aee  7038              STRB     r0,[r7,#0]            ;784
000af0  f8140b01          LDRB     r0,[r4],#1            ;785
000af4  7078              STRB     r0,[r7,#1]            ;785
000af6  f8140b02          LDRB     r0,[r4],#2            ;786
000afa  70b8              STRB     r0,[r7,#2]            ;786
000afc  f8140c01          LDRB     r0,[r4,#-1]           ;787
000b00  70f8              STRB     r0,[r7,#3]            ;787
000b02  a0cd              ADR      r0,|L1.3640|
000b04  f7fffffe          BL       __2printf
000b08  2600              MOVS     r6,#0                 ;790
                  |L1.2826|
000b0a  a0cd              ADR      r0,|L1.3648|
000b0c  5db9              LDRB     r1,[r7,r6]            ;791
000b0e  f7fffffe          BL       __2printf
000b12  1c76              ADDS     r6,r6,#1              ;791
000b14  b2f6              UXTB     r6,r6                 ;790
000b16  2e04              CMP      r6,#4                 ;790
000b18  d3f7              BCC      |L1.2826|
000b1a  a0b4              ADR      r0,|L1.3564|
000b1c  f7fffffe          BL       __2printf
                  |L1.2848|
000b20  4ea8              LDR      r6,|L1.3524|
000b22  f8140b01          LDRB     r0,[r4],#1            ;796
000b26  365a              ADDS     r6,r6,#0x5a           ;796
000b28  7030              STRB     r0,[r6,#0]            ;796
000b2a  f8140b01          LDRB     r0,[r4],#1            ;797
000b2e  7070              STRB     r0,[r6,#1]            ;797
000b30  f8140b01          LDRB     r0,[r4],#1            ;798
000b34  70b0              STRB     r0,[r6,#2]            ;798
000b36  f8140b03          LDRB     r0,[r4],#3            ;799
000b3a  70f0              STRB     r0,[r6,#3]            ;799
000b3c  f8140c02          LDRB     r0,[r4,#-2]           ;800
000b40  7130              STRB     r0,[r6,#4]            ;800
000b42  f8140c01          LDRB     r0,[r4,#-1]           ;801
000b46  7170              STRB     r0,[r6,#5]            ;801
000b48  a0bf              ADR      r0,|L1.3656|
000b4a  f7fffffe          BL       __2printf
000b4e  2700              MOVS     r7,#0                 ;805
                  |L1.2896|
000b50  a0bb              ADR      r0,|L1.3648|
000b52  5df1              LDRB     r1,[r6,r7]            ;806
000b54  f7fffffe          BL       __2printf
000b58  1c7f              ADDS     r7,r7,#1              ;806
000b5a  b2ff              UXTB     r7,r7                 ;805
000b5c  2f06              CMP      r7,#6                 ;805
000b5e  d3f7              BCC      |L1.2896|
000b60  a0a2              ADR      r0,|L1.3564|
000b62  f7fffffe          BL       __2printf
000b66  e000              B        |L1.2922|
                  |L1.2920|
000b68  1c64              ADDS     r4,r4,#1              ;809
                  |L1.2922|
000b6a  42ac              CMP      r4,r5                 ;809
000b6c  d03f              BEQ      |L1.3054|
000b6e  e7fb              B        |L1.2920|
                  |L1.2928|
000b70  a0b9              ADR      r0,|L1.3672|
000b72  f7fffffe          BL       __2printf
000b76  7860              LDRB     r0,[r4,#1]            ;821
000b78  78a1              LDRB     r1,[r4,#2]            ;822
000b7a  1ce4              ADDS     r4,r4,#3              ;822
000b7c  eb012000          ADD      r0,r1,r0,LSL #8       ;822
000b80  b280              UXTH     r0,r0                 ;822
000b82  1821              ADDS     r1,r4,r0              ;823
000b84  48bc              LDR      r0,|L1.3704|
000b86  7822              LDRB     r2,[r4,#0]            ;825
000b88  7002              STRB     r2,[r0,#0]            ;825
000b8a  7862              LDRB     r2,[r4,#1]            ;825
000b8c  7042              STRB     r2,[r0,#1]            ;825
000b8e  78a2              LDRB     r2,[r4,#2]            ;825
000b90  7082              STRB     r2,[r0,#2]            ;825
000b92  78e2              LDRB     r2,[r4,#3]            ;825
000b94  70c2              STRB     r2,[r0,#3]            ;825
000b96  7922              LDRB     r2,[r4,#4]            ;826
000b98  7102              STRB     r2,[r0,#4]            ;826
000b9a  7962              LDRB     r2,[r4,#5]            ;826
000b9c  7142              STRB     r2,[r0,#5]            ;826
000b9e  79a2              LDRB     r2,[r4,#6]            ;826
000ba0  7182              STRB     r2,[r0,#6]            ;826
000ba2  79e2              LDRB     r2,[r4,#7]            ;826
000ba4  71c2              STRB     r2,[r0,#7]            ;826
000ba6  7a22              LDRB     r2,[r4,#8]            ;827
000ba8  7202              STRB     r2,[r0,#8]            ;827
000baa  7a62              LDRB     r2,[r4,#9]            ;827
000bac  7242              STRB     r2,[r0,#9]            ;827
000bae  7aa2              LDRB     r2,[r4,#0xa]          ;827
000bb0  7282              STRB     r2,[r0,#0xa]          ;827
000bb2  7ae2              LDRB     r2,[r4,#0xb]          ;827
000bb4  72c2              STRB     r2,[r0,#0xb]          ;827
000bb6  7b22              LDRB     r2,[r4,#0xc]          ;828
000bb8  7302              STRB     r2,[r0,#0xc]          ;828
000bba  7b62              LDRB     r2,[r4,#0xd]          ;828
000bbc  7342              STRB     r2,[r0,#0xd]          ;828
000bbe  7ba2              LDRB     r2,[r4,#0xe]          ;828
000bc0  7382              STRB     r2,[r0,#0xe]          ;828
000bc2  7be2              LDRB     r2,[r4,#0xf]          ;828
000bc4  73c2              STRB     r2,[r0,#0xf]          ;828
000bc6  3410              ADDS     r4,r4,#0x10           ;828
000bc8  e000              B        |L1.3020|
                  |L1.3018|
000bca  1c64              ADDS     r4,r4,#1              ;830
                  |L1.3020|
000bcc  428c              CMP      r4,r1                 ;830
000bce  d20e              BCS      |L1.3054|
000bd0  e7fb              B        |L1.3018|
                  |L1.3026|
000bd2  a0aa              ADR      r0,|L1.3708|
000bd4  f7fffffe          BL       __2printf
000bd8  7860              LDRB     r0,[r4,#1]            ;843
000bda  78a1              LDRB     r1,[r4,#2]            ;844
000bdc  1ce4              ADDS     r4,r4,#3              ;844
000bde  eb012000          ADD      r0,r1,r0,LSL #8       ;844
000be2  b280              UXTH     r0,r0                 ;844
000be4  4420              ADD      r0,r0,r4              ;845
000be6  e000              B        |L1.3050|
                  |L1.3048|
000be8  1c64              ADDS     r4,r4,#1              ;849
                  |L1.3050|
000bea  4284              CMP      r4,r0                 ;849
000bec  d3fc              BCC      |L1.3048|
                  |L1.3054|
000bee  9817              LDR      r0,[sp,#0x5c]         ;631
000bf0  4284              CMP      r4,r0                 ;631
000bf2  f4ffadd2          BCC      |L1.1946|
                  |L1.3062|
;;;873    						} // case OPTION default...
;;;874                        } // switch
;;;875                    } // while
;;;876                } // case Message Type ADVERTISE
;;;877    		} // switch
;;;878    	//} // if
;;;879    	return	type;
000bf6  980d              LDR      r0,[sp,#0x34]
000bf8  b240              SXTB     r0,r0
                  |L1.3066|
;;;880    }
000bfa  b01b              ADD      sp,sp,#0x6c
000bfc  e8bd8ff0          POP      {r4-r11,pc}
;;;881    
                          ENDP

                  DHCP_run2 PROC
;;;882    uint8_t DHCP_run2(void)
000c00  b570              PUSH     {r4-r6,lr}
;;;883    {
;;;884        uint8_t  type;
;;;885        uint8_t  ret;
;;;886    
;;;887    
;;;888    
;;;889        if(dhcp_state == STATE_DHCP6_STOP) {
000c02  4c70              LDR      r4,|L1.3524|
000c04  7820              LDRB     r0,[r4,#0]  ; dhcp_state
000c06  2806              CMP      r0,#6
000c08  d01e              BEQ      |L1.3144|
;;;890        	return DHCP_STOPPED; // Check DHCP6 STOP State
;;;891        }
;;;892        
;;;893        if(getSn_SR(DHCP_SOCKET) != SOCK_UDP){ // Check DHCP SOCKET == UDP
000c0a  78a0              LDRB     r0,[r4,#2]  ; DHCP_SOCKET
000c0c  49a2              LDR      r1,|L1.3736|
000c0e  eb011040          ADD      r0,r1,r0,LSL #5
000c12  f7fffffe          BL       WIZCHIP_READ
000c16  2822              CMP      r0,#0x22
000c18  d00d              BEQ      |L1.3126|
;;;894            WIZCHIP_WRITE(_Sn_TTLR_(DHCP_SOCKET), 0x01); // hop limit 1 
000c1a  78a0              LDRB     r0,[r4,#2]  ; DHCP_SOCKET
000c1c  499f              LDR      r1,|L1.3740|
000c1e  eb011040          ADD      r0,r1,r0,LSL #5
000c22  2101              MOVS     r1,#1
000c24  f7fffffe          BL       WIZCHIP_WRITE
;;;895            socket(DHCP_SOCKET, (Sn_MR_UDP6), DHCP_CLIENT_PORT, 0x00);
000c28  2300              MOVS     r3,#0
000c2a  f2402222          MOV      r2,#0x222
000c2e  210a              MOVS     r1,#0xa
000c30  78a0              LDRB     r0,[r4,#2]  ; DHCP_SOCKET
000c32  f7fffffe          BL       socket
                  |L1.3126|
;;;896    		}
;;;897    	ret = DHCP_RUNNING;
000c36  2501              MOVS     r5,#1
;;;898    	//InitDhcpOption(20,1);
;;;899        type = parseDHCPMSG();
000c38  f7fffffe          BL       parseDHCPMSG
;;;900        //UnInitDhcpOption();
;;;901    		//printf("dhcp_state : %d \r\n",dhcp_state);
;;;902        switch ( dhcp_state ) {
000c3c  f9941000          LDRSB    r1,[r4,#0]  ; dhcp_state
000c40  b121              CBZ      r1,|L1.3148|
000c42  2905              CMP      r1,#5
000c44  d106              BNE      |L1.3156|
000c46  e007              B        |L1.3160|
                  |L1.3144|
000c48  2005              MOVS     r0,#5                 ;890
;;;903    	    case STATE_DHCP6_INIT    : {
;;;904                send_DHCP_INFOREQ();
;;;905       		    dhcp_state = STATE_DHCP6_RELEASE;
;;;906                break;
;;;907            }
;;;908    		case STATE_DHCP6_RELEASE  : {
;;;909    			return DHCP_IP_LEASED;
;;;910    		}
;;;911            default : {
;;;912                break;
;;;913            }
;;;914        }
;;;915    
;;;916    
;;;917    
;;;918        return ret;
;;;919    }
000c4a  bd70              POP      {r4-r6,pc}
                  |L1.3148|
000c4c  f7fffffe          BL       send_DHCP_INFOREQ
000c50  2005              MOVS     r0,#5                 ;905
000c52  7020              STRB     r0,[r4,#0]            ;905
                  |L1.3156|
000c54  4628              MOV      r0,r5                 ;918
000c56  bd70              POP      {r4-r6,pc}
                  |L1.3160|
000c58  2004              MOVS     r0,#4                 ;909
000c5a  bd70              POP      {r4-r6,pc}
;;;920    
                          ENDP

                  DHCP_run PROC
;;;921    uint8_t DHCP_run(void)
000c5c  b570              PUSH     {r4-r6,lr}
;;;922    {
;;;923        uint8_t  type;
;;;924        uint8_t  ret;
;;;925    
;;;926        if(dhcp_state == STATE_DHCP6_STOP) return DHCP_STOPPED; // Check DHCP6 STOP State
000c5e  4d59              LDR      r5,|L1.3524|
000c60  7828              LDRB     r0,[r5,#0]  ; dhcp_state
000c62  2806              CMP      r0,#6
000c64  d023              BEQ      |L1.3246|
;;;927        
;;;928        if(getSn_SR(DHCP_SOCKET) != SOCK_UDP){ // Check DHCP SOCKET == UDP
000c66  78a8              LDRB     r0,[r5,#2]  ; DHCP_SOCKET
000c68  498b              LDR      r1,|L1.3736|
000c6a  eb011040          ADD      r0,r1,r0,LSL #5
000c6e  f7fffffe          BL       WIZCHIP_READ
000c72  2822              CMP      r0,#0x22
000c74  d00d              BEQ      |L1.3218|
;;;929            WIZCHIP_WRITE(_Sn_TTLR_(DHCP_SOCKET), 0x01); // hop limit 1 
000c76  78a8              LDRB     r0,[r5,#2]  ; DHCP_SOCKET
000c78  4988              LDR      r1,|L1.3740|
000c7a  eb011040          ADD      r0,r1,r0,LSL #5
000c7e  2101              MOVS     r1,#1
000c80  f7fffffe          BL       WIZCHIP_WRITE
;;;930            socket(DHCP_SOCKET, (Sn_MR_UDP6), DHCP_CLIENT_PORT, 0x00);
000c84  2300              MOVS     r3,#0
000c86  f2402222          MOV      r2,#0x222
000c8a  210a              MOVS     r1,#0xa
000c8c  78a8              LDRB     r0,[r5,#2]  ; DHCP_SOCKET
000c8e  f7fffffe          BL       socket
                  |L1.3218|
;;;931    		}
;;;932            
;;;933        ret = DHCP_RUNNING;
000c92  2601              MOVS     r6,#1
;;;934        type = parseDHCPMSG();
000c94  f7fffffe          BL       parseDHCPMSG
000c98  b2c1              UXTB     r1,r0
;;;935        //printf("type:%d, dhcp_state :%d\r\n",type, dhcp_state);
;;;936        switch ( dhcp_state ) {
;;;937    	    case STATE_DHCP6_INIT    : {
;;;938                DHCP_allocated_ip[ 0] = 0; DHCP_allocated_ip[ 1] = 0; DHCP_allocated_ip[ 2] = 0; DHCP_allocated_ip[ 3] = 0;
000c9a  4c77              LDR      r4,|L1.3704|
000c9c  f9950000          LDRSB    r0,[r5,#0]            ;936  ; dhcp_state
000ca0  3410              ADDS     r4,r4,#0x10
000ca2  b130              CBZ      r0,|L1.3250|
000ca4  2801              CMP      r0,#1                 ;936
000ca6  d019              BEQ      |L1.3292|
000ca8  2802              CMP      r0,#2                 ;936
000caa  d145              BNE      |L1.3384|
000cac  e048              B        |L1.3392|
                  |L1.3246|
000cae  2005              MOVS     r0,#5                 ;926
;;;939                DHCP_allocated_ip[ 4] = 0; DHCP_allocated_ip[ 5] = 0; DHCP_allocated_ip[ 6] = 0; DHCP_allocated_ip[ 7] = 0;
;;;940                DHCP_allocated_ip[ 8] = 0; DHCP_allocated_ip[ 9] = 0; DHCP_allocated_ip[10] = 0; DHCP_allocated_ip[11] = 0;
;;;941                DHCP_allocated_ip[12] = 0; DHCP_allocated_ip[13] = 0; DHCP_allocated_ip[14] = 0; DHCP_allocated_ip[15] = 0;
;;;942                
;;;943    			send_DHCP_SOLICIT();
;;;944       		    dhcp_state = STATE_DHCP6_SOLICIT;
;;;945                break;
;;;946            }
;;;947            case STATE_DHCP6_SOLICIT : {
;;;948    			if (type == DHCP6_ADVERTISE){
;;;949                    #ifdef _DHCP6_DEBUG_
;;;950    			    printf("> Receive DHCP_ADVERTISE\r\n");
;;;951                    #endif
;;;952    						
;;;953                    DHCP_allocated_ip[ 0] = recv_IP[ 0]; DHCP_allocated_ip[ 1] = recv_IP[ 1]; 
;;;954    				DHCP_allocated_ip[ 2] = recv_IP[ 2]; DHCP_allocated_ip[ 3] = recv_IP[ 3]; 
;;;955    				DHCP_allocated_ip[ 4] = recv_IP[ 4]; DHCP_allocated_ip[ 5] = recv_IP[ 5]; 
;;;956    			    DHCP_allocated_ip[ 6] = recv_IP[ 6]; DHCP_allocated_ip[ 7] = recv_IP[ 7]; 
;;;957    			    DHCP_allocated_ip[ 8] = recv_IP[ 8]; DHCP_allocated_ip[ 9] = recv_IP[ 9]; 
;;;958    			    DHCP_allocated_ip[10] = recv_IP[10]; DHCP_allocated_ip[11] = recv_IP[11];
;;;959                    DHCP_allocated_ip[12] = recv_IP[12]; DHCP_allocated_ip[13] = recv_IP[13]; 
;;;960    			    DHCP_allocated_ip[14] = recv_IP[14]; DHCP_allocated_ip[15] = recv_IP[15];
;;;961                
;;;962    			    ret = send_DHCP_REQUEST();
;;;963    			    if(ret == 9){
;;;964    			    	return 0;
;;;965    			    }
;;;966    		        dhcp_state = STATE_DHCP6_REQUEST;
;;;967                }//else ret = check_DHCP_timeout();
;;;968    			break;
;;;969    		}
;;;970            case STATE_DHCP6_REQUEST : {
;;;971    			NETUNLOCK();
;;;972    			setGUAR(recv_IP);
;;;973    			NETLOCK();
;;;974                return DHCP_IP_LEASED;
;;;975    		}
;;;976            default : {
;;;977                break;
;;;978            }
;;;979        }
;;;980        return ret;
;;;981    }
000cb0  bd70              POP      {r4-r6,pc}
                  |L1.3250|
000cb2  2000              MOVS     r0,#0                 ;938
000cb4  7020              STRB     r0,[r4,#0]            ;938
000cb6  7060              STRB     r0,[r4,#1]            ;938
000cb8  70a0              STRB     r0,[r4,#2]            ;938
000cba  70e0              STRB     r0,[r4,#3]            ;938
000cbc  7120              STRB     r0,[r4,#4]            ;939
000cbe  7160              STRB     r0,[r4,#5]            ;939
000cc0  71a0              STRB     r0,[r4,#6]            ;939
000cc2  71e0              STRB     r0,[r4,#7]            ;939
000cc4  7220              STRB     r0,[r4,#8]            ;940
000cc6  7260              STRB     r0,[r4,#9]            ;940
000cc8  72a0              STRB     r0,[r4,#0xa]          ;940
000cca  72e0              STRB     r0,[r4,#0xb]          ;940
000ccc  7320              STRB     r0,[r4,#0xc]          ;941
000cce  7360              STRB     r0,[r4,#0xd]          ;941
000cd0  73a0              STRB     r0,[r4,#0xe]          ;941
000cd2  73e0              STRB     r0,[r4,#0xf]          ;941
000cd4  f7fffffe          BL       send_DHCP_SOLICIT
000cd8  2001              MOVS     r0,#1                 ;944
000cda  e02c              B        |L1.3382|
                  |L1.3292|
000cdc  2902              CMP      r1,#2                 ;948
000cde  d12b              BNE      |L1.3384|
000ce0  a06f              ADR      r0,|L1.3744|
000ce2  f7fffffe          BL       __2printf
000ce6  4864              LDR      r0,|L1.3704|
000ce8  3020              ADDS     r0,r0,#0x20           ;953
000cea  7801              LDRB     r1,[r0,#0]            ;953  ; recv_IP
000cec  7021              STRB     r1,[r4,#0]            ;953
000cee  7841              LDRB     r1,[r0,#1]            ;953  ; recv_IP
000cf0  7061              STRB     r1,[r4,#1]            ;953
000cf2  7881              LDRB     r1,[r0,#2]            ;954  ; recv_IP
000cf4  70a1              STRB     r1,[r4,#2]            ;954
000cf6  78c1              LDRB     r1,[r0,#3]            ;954  ; recv_IP
000cf8  70e1              STRB     r1,[r4,#3]            ;954
000cfa  7901              LDRB     r1,[r0,#4]            ;955  ; recv_IP
000cfc  7121              STRB     r1,[r4,#4]            ;955
000cfe  7941              LDRB     r1,[r0,#5]            ;955  ; recv_IP
000d00  7161              STRB     r1,[r4,#5]            ;955
000d02  7981              LDRB     r1,[r0,#6]            ;956  ; recv_IP
000d04  71a1              STRB     r1,[r4,#6]            ;956
000d06  79c1              LDRB     r1,[r0,#7]            ;956  ; recv_IP
000d08  71e1              STRB     r1,[r4,#7]            ;956
000d0a  7a01              LDRB     r1,[r0,#8]            ;957  ; recv_IP
000d0c  7221              STRB     r1,[r4,#8]            ;957
000d0e  7a41              LDRB     r1,[r0,#9]            ;957  ; recv_IP
000d10  7261              STRB     r1,[r4,#9]            ;957
000d12  7a81              LDRB     r1,[r0,#0xa]          ;958  ; recv_IP
000d14  72a1              STRB     r1,[r4,#0xa]          ;958
000d16  7ac1              LDRB     r1,[r0,#0xb]          ;958  ; recv_IP
000d18  72e1              STRB     r1,[r4,#0xb]          ;958
000d1a  7b01              LDRB     r1,[r0,#0xc]          ;959  ; recv_IP
000d1c  7321              STRB     r1,[r4,#0xc]          ;959
000d1e  7b41              LDRB     r1,[r0,#0xd]          ;959  ; recv_IP
000d20  7361              STRB     r1,[r4,#0xd]          ;959
000d22  7b81              LDRB     r1,[r0,#0xe]          ;960  ; recv_IP
000d24  73a1              STRB     r1,[r4,#0xe]          ;960
000d26  7bc0              LDRB     r0,[r0,#0xf]          ;960  ; recv_IP
000d28  73e0              STRB     r0,[r4,#0xf]          ;960
000d2a  f7fffffe          BL       send_DHCP_REQUEST
000d2e  4606              MOV      r6,r0                 ;962
000d30  2809              CMP      r0,#9                 ;963
000d32  d003              BEQ      |L1.3388|
000d34  2002              MOVS     r0,#2                 ;966
                  |L1.3382|
000d36  7028              STRB     r0,[r5,#0]            ;966
                  |L1.3384|
000d38  4630              MOV      r0,r6                 ;980
000d3a  bd70              POP      {r4-r6,pc}
                  |L1.3388|
000d3c  2000              MOVS     r0,#0                 ;964
000d3e  bd70              POP      {r4-r6,pc}
                  |L1.3392|
000d40  4c5e              LDR      r4,|L1.3772|
000d42  213a              MOVS     r1,#0x3a              ;971
000d44  4620              MOV      r0,r4                 ;971
000d46  f7fffffe          BL       WIZCHIP_WRITE
000d4a  494b              LDR      r1,|L1.3704|
000d4c  2210              MOVS     r2,#0x10              ;972
000d4e  3120              ADDS     r1,r1,#0x20           ;972
000d50  485b              LDR      r0,|L1.3776|
000d52  f7fffffe          BL       WIZCHIP_WRITE_BUF
000d56  21c5              MOVS     r1,#0xc5              ;973
000d58  4620              MOV      r0,r4                 ;973
000d5a  f7fffffe          BL       WIZCHIP_WRITE
000d5e  2004              MOVS     r0,#4                 ;974
000d60  bd70              POP      {r4-r6,pc}
;;;982    
                          ENDP

                  DHCP_stop PROC
;;;983    void DHCP_stop(void)
000d62  b510              PUSH     {r4,lr}
;;;984    {
;;;985        close(DHCP_SOCKET);
000d64  4c17              LDR      r4,|L1.3524|
000d66  78a0              LDRB     r0,[r4,#2]  ; DHCP_SOCKET
000d68  f7fffffe          BL       close
;;;986        dhcp_state = STATE_DHCP6_STOP;
000d6c  2006              MOVS     r0,#6
000d6e  7020              STRB     r0,[r4,#0]
;;;987    }
000d70  bd10              POP      {r4,pc}
;;;988    
                          ENDP

                  reset_DHCP_timeout PROC
;;;1056   /* Rset the DHCP timeout count and retry count. */
;;;1057   void reset_DHCP_timeout(void)
000d72  4814              LDR      r0,|L1.3524|
;;;1058   {
;;;1059   	dhcp_tick_1s = 0;
000d74  2100              MOVS     r1,#0
000d76  6181              STR      r1,[r0,#0x18]  ; dhcp_tick_1s
;;;1060   	dhcp_tick_next = DHCP_WAIT_TIME;
000d78  220a              MOVS     r2,#0xa
;;;1061   	dhcp_retry_count = 0;
000d7a  61c2              STR      r2,[r0,#0x1c]  ; dhcp_tick_next
000d7c  7041              STRB     r1,[r0,#1]
;;;1062   }
000d7e  4770              BX       lr
;;;1063   
                          ENDP

                  check_DHCP_timeout PROC
;;;988    
;;;989    uint8_t check_DHCP_timeout(void)
000d80  b570              PUSH     {r4-r6,lr}
;;;990    {
;;;991        uint8_t ret = DHCP_RUNNING;
;;;992    	
;;;993        if(dhcp_retry_count < MAX_DHCP_RETRY) {
000d82  4c10              LDR      r4,|L1.3524|
000d84  2501              MOVS     r5,#1                 ;991
000d86  4621              MOV      r1,r4
000d88  f9940001          LDRSB    r0,[r4,#1]  ; dhcp_retry_count
000d8c  2600              MOVS     r6,#0
;;;994    		if(dhcp_tick_next < dhcp_tick_1s) {
;;;995                switch ( dhcp_state ) {
000d8e  f9911000          LDRSB    r1,[r1,#0]
000d92  2802              CMP      r0,#2                 ;993
000d94  da06              BGE      |L1.3492|
000d96  e9d42006          LDRD     r2,r0,[r4,#0x18]      ;994
000d9a  4290              CMP      r0,r2                 ;994
000d9c  d203              BCS      |L1.3494|
000d9e  2901              CMP      r1,#1
000da0  d102              BNE      |L1.3496|
;;;996                    case STATE_DHCP6_SOLICIT : {
;;;997                        #ifdef _DHCP6_DEBUG_
;;;998    					printf("<<timeout>> state : STATE_DHCP_DISCOVER\r\n");
000da2  e08f              B        |L1.3780|
                  |L1.3492|
000da4  e09b              B        |L1.3806|
                  |L1.3494|
000da6  e0a0              B        |L1.3818|
                  |L1.3496|
000da8  e091              B        |L1.3790|
000daa  0000              DCW      0x0000
                  |L1.3500|
                          DCD      ||.conststring||+0x6c
                  |L1.3504|
000db0  696e2073          DCB      "in status code \r\n",0
000db4  74617475
000db8  7320636f
000dbc  6465200d
000dc0  0a00    
000dc2  00                DCB      0
000dc3  00                DCB      0
                  |L1.3524|
                          DCD      ||.data||
                  |L1.3528|
000dc8  73746174          DCB      "status_len : %x\r\n",0
000dcc  75735f6c
000dd0  656e203a
000dd4  2025780d
000dd8  0a00    
000dda  00                DCB      0
000ddb  00                DCB      0
                  |L1.3548|
000ddc  4c737461          DCB      "Lstatus_len : %x"
000de0  7475735f
000de4  6c656e20
000de8  3a202578
                  |L1.3564|
000dec  0d0a00            DCB      "\r\n",0
000def  00                DCB      0
                  |L1.3568|
000df0  696e2069          DCB      "in iata \r\n",0
000df4  61746120
000df8  0d0a00  
000dfb  00                DCB      0
                  |L1.3580|
000dfc  696e2073          DCB      "in serverid \r\n",0
000e00  65727665
000e04  72696420
000e08  0d0a00  
000e0b  00                DCB      0
                  |L1.3596|
000e0c  44554944          DCB      "DUID_type : %.4x\r\n",0
000e10  5f747970
000e14  65203a20
000e18  252e3478
000e1c  0d0a00  
000e1f  00                DCB      0
                  |L1.3616|
000e20  48617264          DCB      "Hardware_type : %.4x\r\n",0
000e24  77617265
000e28  5f747970
000e2c  65203a20
000e30  252e3478
000e34  0d0a00  
000e37  00                DCB      0
                  |L1.3640|
000e38  54696d65          DCB      "Time : ",0
000e3c  203a2000
                  |L1.3648|
000e40  252e3278          DCB      "%.2x",0
000e44  00      
000e45  00                DCB      0
000e46  00                DCB      0
000e47  00                DCB      0
                  |L1.3656|
000e48  53657276          DCB      "Server_MAC : ",0
000e4c  65725f4d
000e50  4143203a
000e54  2000    
000e56  00                DCB      0
000e57  00                DCB      0
                  |L1.3672|
000e58  696e2044          DCB      "in DNS Recursive Name Server \r\n",0
000e5c  4e532052
000e60  65637572
000e64  73697665
000e68  204e616d
000e6c  65205365
000e70  72766572
000e74  200d0a00
                  |L1.3704|
                          DCD      ||.bss||
                  |L1.3708|
000e7c  696e2044          DCB      "in Domain Search List \r\n",0
000e80  6f6d6169
000e84  6e205365
000e88  61726368
000e8c  204c6973
000e90  74200d0a
000e94  00      
000e95  00                DCB      0
000e96  00                DCB      0
000e97  00                DCB      0
                  |L1.3736|
                          DCD      0x60003008
                  |L1.3740|
                          DCD      0x60010808
                  |L1.3744|
000ea0  3e205265          DCB      "> Receive DHCP_ADVERTISE\r\n",0
000ea4  63656976
000ea8  65204448
000eac  43505f41
000eb0  44564552
000eb4  54495345
000eb8  0d0a00  
000ebb  00                DCB      0
                  |L1.3772|
                          DCD      0x6041f500
                  |L1.3776|
                          DCD      0x60415000
                  |L1.3780|
000ec4  a02f              ADR      r0,|L1.3972|
000ec6  f7fffffe          BL       __2printf
;;;999    					#endif
;;;1000   					send_DHCP_SOLICIT();
000eca  f7fffffe          BL       send_DHCP_SOLICIT
                  |L1.3790|
;;;1001   				    break;
;;;1002   				}
;;;1003   				default : {
;;;1004   				    break;
;;;1005   				}
;;;1006   			}
;;;1007   
;;;1008   			dhcp_tick_1s = 0;
000ece  61a6              STR      r6,[r4,#0x18]  ; dhcp_tick_1s
;;;1009   			dhcp_tick_next = dhcp_tick_1s + DHCP_WAIT_TIME;
000ed0  69a0              LDR      r0,[r4,#0x18]  ; dhcp_tick_1s
000ed2  300a              ADDS     r0,r0,#0xa
;;;1010   			dhcp_retry_count++;
000ed4  61e0              STR      r0,[r4,#0x1c]  ; dhcp_tick_next
000ed6  7860              LDRB     r0,[r4,#1]  ; dhcp_retry_count
000ed8  1c40              ADDS     r0,r0,#1
000eda  7060              STRB     r0,[r4,#1]
000edc  e005              B        |L1.3818|
                  |L1.3806|
;;;1011   		}
;;;1012   	}
;;;1013   	else { // timeout occurred
;;;1014   
;;;1015   		switch(dhcp_state) {
000ede  2901              CMP      r1,#1
000ee0  d101              BNE      |L1.3814|
;;;1016   			case STATE_DHCP6_SOLICIT:
;;;1017   				dhcp_state = STATE_DHCP6_INIT;
000ee2  7026              STRB     r6,[r4,#0]
;;;1018   				ret = DHCP_FAILED;
000ee4  2500              MOVS     r5,#0
                  |L1.3814|
;;;1019   				break;
;;;1020   			default :
;;;1021   				break;
;;;1022   		}
;;;1023   		reset_DHCP_timeout();
000ee6  f7fffffe          BL       reset_DHCP_timeout
                  |L1.3818|
;;;1024   	}
;;;1025   	return ret;
000eea  4628              MOV      r0,r5
;;;1026   }
000eec  bd70              POP      {r4-r6,pc}
;;;1027   
                          ENDP

                  DHCP_init PROC
;;;1028   void DHCP_init(uint8_t s, uint8_t * buf)
000eee  e92d41ff          PUSH     {r0-r8,lr}
;;;1029   {
;;;1030       uint8_t zeroip[16] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
000ef2  2400              MOVS     r4,#0
;;;1031       getSHAR(DHCP_CHADDR);
000ef4  f8df80bc          LDR      r8,|L1.4020|
000ef8  460e              MOV      r6,r1                 ;1029
000efa  4607              MOV      r7,r0                 ;1029
000efc  9400              STR      r4,[sp,#0]            ;1030
000efe  9401              STR      r4,[sp,#4]            ;1030
000f00  9402              STR      r4,[sp,#8]            ;1030
000f02  2206              MOVS     r2,#6
000f04  492a              LDR      r1,|L1.4016|
000f06  4640              MOV      r0,r8
000f08  9403              STR      r4,[sp,#0xc]
000f0a  f7fffffe          BL       WIZCHIP_READ_BUF
;;;1032       if((DHCP_CHADDR[0] | DHCP_CHADDR[1]  | DHCP_CHADDR[2] | DHCP_CHADDR[3] | DHCP_CHADDR[4] | DHCP_CHADDR[5]) == 0x00)
000f0e  4d28              LDR      r5,|L1.4016|
000f10  7828              LDRB     r0,[r5,#0]  ; DHCP_CHADDR
000f12  7869              LDRB     r1,[r5,#1]  ; DHCP_CHADDR
000f14  78ea              LDRB     r2,[r5,#3]  ; DHCP_CHADDR
000f16  4308              ORRS     r0,r0,r1
000f18  78a9              LDRB     r1,[r5,#2]  ; DHCP_CHADDR
000f1a  4311              ORRS     r1,r1,r2
000f1c  4308              ORRS     r0,r0,r1
000f1e  7929              LDRB     r1,[r5,#4]  ; DHCP_CHADDR
000f20  4308              ORRS     r0,r0,r1
000f22  7969              LDRB     r1,[r5,#5]  ; DHCP_CHADDR
000f24  4308              ORRS     r0,r0,r1
000f26  d10f              BNE      |L1.3912|
;;;1033       {
;;;1034           #ifdef _DHCP6_DEBUG_
;;;1035           printf("DHCP_init-set MAC\r\n");
000f28  a023              ADR      r0,|L1.4024|
000f2a  f7fffffe          BL       __2printf
;;;1036   		#endif
;;;1037   		// assing temporary mac address, you should be set SHAR before call this function. 
;;;1038           DHCP_CHADDR[0] = 0x00; DHCP_CHADDR[1] = 0x08; DHCP_CHADDR[2] = 0xdc;
000f2e  702c              STRB     r4,[r5,#0]
000f30  2008              MOVS     r0,#8
000f32  7068              STRB     r0,[r5,#1]
000f34  20dc              MOVS     r0,#0xdc
000f36  70a8              STRB     r0,[r5,#2]
;;;1039   		DHCP_CHADDR[3] = 0x00; DHCP_CHADDR[4] = 0x00; DHCP_CHADDR[5] = 0x00;
000f38  70ec              STRB     r4,[r5,#3]
000f3a  712c              STRB     r4,[r5,#4]
000f3c  716c              STRB     r4,[r5,#5]
;;;1040           setSHAR(DHCP_CHADDR);     
000f3e  2206              MOVS     r2,#6
000f40  4629              MOV      r1,r5
000f42  4640              MOV      r0,r8
000f44  f7fffffe          BL       WIZCHIP_WRITE_BUF
                  |L1.3912|
;;;1041       }
;;;1042   
;;;1043   	DHCP_SOCKET = s; // SOCK_DHCP
000f48  4d19              LDR      r5,|L1.4016|
;;;1044   	pDHCPMSG.OPT = buf;
;;;1045   	DHCP_XID = 0x515789;
;;;1046   
;;;1047   	//WIZchip Netinfo Clear
;;;1048   	setSIPR(zeroip);
000f4a  2204              MOVS     r2,#4
000f4c  3d54              SUBS     r5,r5,#0x54           ;1043
000f4e  f1050028          ADD      r0,r5,#0x28           ;1044
000f52  70af              STRB     r7,[r5,#2]            ;1043
000f54  6006              STR      r6,[r0,#0]            ;1045  ; pDHCPMSG
000f56  481d              LDR      r0,|L1.4044|
000f58  6268              STR      r0,[r5,#0x24]  ; DHCP_XID
000f5a  4669              MOV      r1,sp
000f5c  481c              LDR      r0,|L1.4048|
000f5e  f7fffffe          BL       WIZCHIP_WRITE_BUF
;;;1049   	setGAR(zeroip);
000f62  2204              MOVS     r2,#4
000f64  4669              MOV      r1,sp
000f66  481b              LDR      r0,|L1.4052|
000f68  f7fffffe          BL       WIZCHIP_WRITE_BUF
;;;1050   
;;;1051   	reset_DHCP_timeout();
000f6c  f7fffffe          BL       reset_DHCP_timeout
;;;1052   	dhcp_state = STATE_DHCP6_INIT;
000f70  702c              STRB     r4,[r5,#0]
;;;1053   }
000f72  e8bd81ff          POP      {r0-r8,pc}
;;;1054   
                          ENDP

                  DHCP_time_handler PROC
;;;1063   
;;;1064   void DHCP_time_handler(void)
000f76  480e              LDR      r0,|L1.4016|
;;;1065   {
;;;1066   	dhcp_tick_1s++;
000f78  3854              SUBS     r0,r0,#0x54
000f7a  6981              LDR      r1,[r0,#0x18]  ; dhcp_tick_1s
000f7c  1c49              ADDS     r1,r1,#1
000f7e  6181              STR      r1,[r0,#0x18]  ; dhcp_tick_1s
;;;1067   }
000f80  4770              BX       lr
;;;1068   
                          ENDP

000f82  0000              DCW      0x0000
                  |L1.3972|
000f84  3c3c7469          DCB      "<<timeout>> state : STATE_DHCP_DISCOVER\r\n",0
000f88  6d656f75
000f8c  743e3e20
000f90  73746174
000f94  65203a20
000f98  53544154
000f9c  455f4448
000fa0  43505f44
000fa4  4953434f
000fa8  5645520d
000fac  0a00    
000fae  00                DCB      0
000faf  00                DCB      0
                  |L1.4016|
                          DCD      ||.data||+0x54
                  |L1.4020|
                          DCD      0x60412000
                  |L1.4024|
000fb8  44484350          DCB      "DHCP_init-set MAC\r\n",0
000fbc  5f696e69
000fc0  742d7365
000fc4  74204d41
000fc8  430d0a00
                  |L1.4044|
                          DCD      0x00515789
                  |L1.4048|
                          DCD      0x60413800
                  |L1.4052|
                          DCD      0x60413000

                          AREA ||.bss||, DATA, NOINIT, ALIGN=0

                  DNS6_Address
                          %        16
                  DHCP_allocated_ip
                          %        16
                  recv_IP
                          %        16

                          AREA ||area_number.4||, DATA, NOINIT, ALIGN=0

                          EXPORTAS ||area_number.4||, ||.bss||
                  OLD_allocated_ip
                          %        16

                          AREA ||area_number.5||, DATA, NOINIT, ALIGN=0

                          EXPORTAS ||area_number.5||, ||.bss||
                  DHCP_allocated_gw
                          %        16

                          AREA ||area_number.6||, DATA, NOINIT, ALIGN=0

                          EXPORTAS ||area_number.6||, ||.bss||
                  DHCP_allocated_sn
                          %        16

                          AREA ||area_number.7||, DATA, NOINIT, ALIGN=0

                          EXPORTAS ||area_number.7||, ||.bss||
                  DHCP_allocated_dns
                          %        16

                          AREA ||area_number.8||, DATA, NOINIT, ALIGN=0

                          EXPORTAS ||area_number.8||, ||.bss||
                  DHCP_SIP
                          %        16

                          AREA ||.conststring||, DATA, READONLY, MERGE=1, STRINGS, ALIGN=2

000000  44484350          DCB      "DHCP message : %.2x%.2x:%.2x%.2x:%.2x%.2x:%.2x%.2x:%.2x"
000004  206d6573
000008  73616765
00000c  203a2025
000010  2e327825
000014  2e32783a
000018  252e3278
00001c  252e3278
000020  3a252e32
000024  78252e32
000028  783a252e
00002c  3278252e
000030  32783a25
000034  2e3278  
000037  252e3278          DCB      "%.2x:%.2x%.2x:%.2x%.2x:%.2x%.2x(%d) %d received. \r\n",0
00003b  3a252e32
00003f  78252e32
000043  783a252e
000047  3278252e
00004b  32783a25
00004f  2e327825
000053  2e327828
000057  25642920
00005b  25642072
00005f  65636569
000063  7665642e
000067  200d0a00
00006b  00                DCB      0
00006c  49414e41          DCB      "IANA : %.2x%.2x:%.2x%.2x:%.2x%.2x:%.2x%.2x:%.2x%.2x:%.2"
000070  203a2025
000074  2e327825
000078  2e32783a
00007c  252e3278
000080  252e3278
000084  3a252e32
000088  78252e32
00008c  783a252e
000090  3278252e
000094  32783a25
000098  2e327825
00009c  2e32783a
0000a0  252e32  
0000a3  78252e32          DCB      "x%.2x:%.2x%.2x:%.2x%.2x \r\n",0
0000a7  783a252e
0000ab  3278252e
0000af  32783a25
0000b3  2e327825
0000b7  2e327820
0000bb  0d0a00  

                          AREA ||.data||, DATA, ALIGN=2

                  dhcp_state
000000  00                DCB      0x00
                  dhcp_retry_count
000001  00                DCB      0x00
                  DHCP_SOCKET
000002  0000              DCB      0x00,0x00
                  DUID_type_s
000004  0000              DCB      0x00,0x00
                  Hardware_type_s
000006  0000              DCB      0x00,0x00
                  code
000008  0000              DCB      0x00,0x00
                  iana_len
00000a  0000              DCB      0x00,0x00
                  iaaddr_len
00000c  0000              DCB      0x00,0x00
                  statuscode_len
00000e  0000              DCB      0x00,0x00
                  Lstatuscode_len
000010  0000              DCB      0x00,0x00
                  serverid_len
000012  0000              DCB      0x00,0x00
                  clientid_len
000014  00000000          DCB      0x00,0x00,0x00,0x00
                  dhcp_tick_1s
                          DCD      0x00000000
                  dhcp_tick_next
                          DCD      0x0000000a
                  num2
                          DCD      0x00000000
                  DHCP_XID
                          DCD      0x00000000
                  pDHCPMSG
                          DCD      0x00000000
                  Time_s
                          DCD      0x00000000
                  Enterprise_num_s
                          DCD      0x00000000
                  PreLifeTime
                          DCD      0x00000000
                  ValidLifeTime
                          DCD      0x00000000
                  IAID
                          DCD      0x00000000
                  ||T1||
                          DCD      0x00000000
                  ||T2||
                          DCD      0x00000000
                  size
                          DCD      0x00000000
                  num
                          DCD      0x00000000
                  growby
                          DCD      0x00000000
                  DHCP_CHADDR
                          DCD      0x00000000
000058  0000              DCB      0x00,0x00
                  Server_MAC
00005a  0000              DCB      0x00,0x00
                          DCD      0x00000000

                          AREA ||area_number.12||, DATA, ALIGN=2

                          EXPORTAS ||area_number.12||, ||.data||
                  a
                          DCD      0x00000005

                          AREA ||area_number.13||, DATA, ALIGN=0

                          EXPORTAS ||area_number.13||, ||.data||
                  HOST_NAME
000000  57495a6e          DCB      0x57,0x49,0x5a,0x6e
000004  65740000          DCB      0x65,0x74,0x00,0x00

                          AREA ||area_number.14||, DATA, ALIGN=0

                          EXPORTAS ||area_number.14||, ||.data||
                  status_msg
000000  00                DCB      0x00
